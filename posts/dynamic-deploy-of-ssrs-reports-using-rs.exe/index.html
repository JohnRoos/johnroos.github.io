 
 

 

 

 

 

 


<!DOCTYPE html>
<html lang="en">




    



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <meta name='twitter:card'        content='summary' />
    <meta name='twitter:site'        content='@johnmroos'/>
    <meta name='twitter:creator'     content='@johnmroos'/>
    <meta name='twitter:title'       content='Dynamic deploy of SSRS reports using rs.exe' />
    <meta name='twitter:description' content='This script will search for reports in the local folder SOURCEREPORTFOLDER and then deploy them in the RS folder TARGETRSFOLDER, creating subfolders if needed. If any of the reports already exists in RS it will first do a backup of the existing report into the local folder BACKUPLOCATION. The target folder in RS will contain the same file structure as the source folder. Subfolders will be created if they don&rsquo;t already exists and so on.' />
    
    <meta name='twitter:domain'      content='https://blog.roostech.se/'/>
    

    <title>Dynamic deploy of SSRS reports using rs.exe</title>
    <meta name="description" content="This script will search for reports in the local folder SOURCEREPORTFOLDER and then deploy them in the RS folder TARGETRSFOLDER, creating subfolders if needed. If any of the reports already exists in RS it will first do a backup of the existing report into the local folder BACKUPLOCATION. The target folder in RS will contain the same file structure as the source folder. Subfolders will be created if they don&rsquo;t already exists and so on."/>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-35019756-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle">
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><div class="menu-item folder open"><a class="menu-item-site" href="https://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></div>
            <ul>  
                <li><span class="menu-item folder open">content</span>
                    <ul>
                        <li><span class="menu-item folder open">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li ><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li ><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li class="current"><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="menu-item folder open">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><span class="menu-item folder">data</span></li>
                <li><span class="menu-item folder">layouts</span></li>
                <li><span class="menu-item folder">resources</span></li>
                <li><span class="menu-item folder">static</span></li>
                <li><span class="menu-item folder open">themes</span>
                    <ul>
                        <li><span class="menu-item folder open">hugovscode</span>
                            <ul>
                                <li><a href="https://github.com/JohnRoos/HugoVSCode/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">.git</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV>
                <div class ="main-tabs">
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                    </div>
                
                    <div class="main-tab current">
                        <span class="rotate-letter md-icon">&#10144;</span> <i>Dynamic deploy of SSRS reports using rs.exe.md</i> 
                    </div>
                
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/pester-5-discovery-and-testcases/">Pester 5: Discovery and TestCases.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/create-and-use-azure-table-storage-with-powershell/">Create and use Azure Table storage with PowerShell.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/">Use Edit-Command to discover the code behind built-in cmdlets.md</a>
                    </div>
                
                </div>
            
            
            <div class='main'>
    <div class="main-path">
        <span><a class="path-link" href="https://blog.roostech.se/">blog.roostech.se</a></span><span class="folder">content</span><span class="folder">posts</span><span class="folder">Dynamic deploy of SSRS reports using rs.exe.md</span>
        
                
                
                <span class="postdate-container">&nbsp;(<time class="postdate" datetime="2012-03-01">March 1, 2012</time>)</span>
            
    </div>
    
    <div class="main-content-toggle">

        
        <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
        <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

        <input class="source-toggle" type="checkbox" id="source-toggle">
        <label class="source-toggle-label" for="source-toggle"></label>

        <div class="main-content">
            ---<br />
            <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">Dynamic deploy of SSRS reports using rs.exe</span><br />
            <span class="md-frontmatter">date</span>: 2012-03-01 14:14:00 &#43;0200 &#43;0200<br />
            <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
            <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John</span><br />
            ----
            <p>This script will search for reports in the local folder SOURCEREPORTFOLDER and then deploy them in the RS folder TARGETRSFOLDER, creating subfolders if needed. If any of the reports already exists in RS it will first do a backup of the existing report into the local folder BACKUPLOCATION. The target folder in RS will contain the same file structure as the source folder. Subfolders will be created if they don&rsquo;t already exists and so on. All actions are logged to a log file for each deploy.</p>
<p>This script expects only one datasource for all reports. If the datasource has a different name in the target environment than where it was developed you will get an error in the log when the report first is deployed, but the script will after that set the proper data source and it will work anyway. The reason for this is that the report expects a data source with a certain name and the script can only set the correct data source after the report has been deployed. If you are confident that the script works (after extensive testing) you can suppress these messages by setting the variable SuppressWarnings to true in the rss file but I am not sure if thats a good idea.</p>
<p>I tried to create a unique log file name for each deploy but since date and time is acting a bit weird when running batch scripts I resorted to having a random number in the end of the log file. Not pretty but it works. All you need to do to test the script is to modify the the beginning of the batch script. The variables need to be set according to your needs.</p>
<p>How to test the scripts:</p>
<ol>
<li>Save both scripts (DeployReports.cmd &amp; DeployReports.rss) into the folder of your choice. In your selected folder, create two subfolders named Reports and Log.</li>
<li>Put the reports you want to deploy into the Reports folder.</li>
<li>Create the &ldquo;root&rdquo; folder where the reports should be deployed in RS. Also create the datasource before deploying the reports.</li>
<li>Edit the bat to adapt the variables to your environment. The lines you need to edit is highlighter below.</li>
<li>Run the bat file in a command prompt, on the machine where RS is running.</li>
</ol>
<p>I added some debug features in the rss script which helped me while developing the script and if you want to turn debug on there is a variable called DebugComments which you can set to true. The scripts should work on both Reporting Services 2005 and 2008.</p>
<h2 id="deployreportscmd">DeployReports.cmd</h2>
<div class="highlight"><pre class="chroma"><code class="language-cmd" data-lang="cmd"><span class="p">@</span><span class="k">echo</span> on
<span class="p">:</span><span class="c1">: ** Script generated by Reporting Services Scripter 2.0.0.17 **</span>
<span class="p">:</span><span class="c1">: ** Created by Jasper Smith (jas@sqldbatips.com)             **</span>
<span class="p">:</span><span class="c1">: ** See http://www.sqldbatips.com for help/support           **</span>
 
<span class="p">:</span><span class="c1">:Requires Reports and Log folder to work</span>
 
<span class="p">:</span><span class="c1">:Script Variables</span>
<span class="k">SET</span> <span class="nv">SOURCEREPORTFOLDER</span><span class="p">=</span>Reports
<span class="k">SET</span> <span class="nv">ORIGINALDATASOURCE</span><span class="p">=</span>Datasource
<span class="k">SET</span> <span class="nv">REPORTSERVER</span><span class="p">=</span>http://localhost/ReportServer
<span class="k">SET</span> <span class="nv">TARGETRSFOLDER</span><span class="p">=</span>LABfolder
<span class="k">SET</span> <span class="nv">TARGETDATASOURCE</span><span class="p">=</span>Datasource
 
<span class="k">SET</span> <span class="nv">SCRIPTLOCATION</span><span class="p">=</span>DeployReports.rss
<span class="k">SET</span> <span class="nv">RS</span><span class="p">=</span><span class="s2">&#34;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\rs.exe&#34;</span>
<span class="k">SET</span> <span class="nv">TIMEOUT</span><span class="p">=</span>60
 
 
 
<span class="p">:</span><span class="c1">:Generate suffix for log and backup</span>
<span class="p">@</span><span class="k">For</span> <span class="k">/F</span> <span class="s2">&#34;tokens=1,2,3 delims=/ &#34;</span> <span class="se">%%</span>A <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;Date /t&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">@(</span> 
<span class="k">Set</span> <span class="nv">Day</span><span class="p">=</span><span class="se">%%</span>A
<span class="k">Set</span> <span class="nv">Month</span><span class="p">=</span><span class="se">%%</span>B
<span class="k">Set</span> <span class="nv">Year</span><span class="p">=</span><span class="se">%%</span>C
<span class="k">Set</span> <span class="nv">Dat</span><span class="p">=</span><span class="se">%%</span>C<span class="se">%%</span>B<span class="se">%%</span>A
<span class="p">)</span>
<span class="p">@</span><span class="k">For</span> <span class="k">/F</span> <span class="s2">&#34;tokens=1,2 delims=: &#34;</span> <span class="se">%%</span>A <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;time /t&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">@(</span> 
<span class="k">Set</span> <span class="nv">Hour</span><span class="p">=</span><span class="se">%%</span>A
<span class="k">Set</span> <span class="nv">Minute</span><span class="p">=</span><span class="se">%%</span>B
<span class="k">Set</span> <span class="nv">tim</span><span class="p">=</span><span class="se">%%</span>A<span class="se">%%</span>B_r<span class="nv">%random%</span>
<span class="p">)</span>
 
<span class="k">SET</span> <span class="nv">LOGFILE</span><span class="p">=</span><span class="s2">&#34;log\DeployReports_</span><span class="nv">%dat%</span><span class="s2">_</span><span class="nv">%tim%</span><span class="s2">.log&#34;</span>
<span class="k">SET</span> <span class="nv">BACKUPLOCATION</span><span class="p">=</span>Backup\Bak_<span class="nv">%dat%</span>_<span class="nv">%tim%</span>\\
 
<span class="p">:</span><span class="c1">:Write Log Header</span>
<span class="k">ECHO</span> Reporting Services Scripter Load Log 2.0.0.17 <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Starting Load at <span class="nv">%DATE%</span> <span class="nv">%TIME%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Variables:
<span class="k">ECHO</span> SOURCEREPORTFOLDER  = <span class="nv">%SOURCEREPORTFOLDER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> ORIGINALDATASOOURCE = <span class="nv">%ORIGINALDATASOURCE%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> REPORTSERVER        = <span class="nv">%REPORTSERVER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TARGETRSFOLDER      = <span class="nv">%TARGETRSFOLDER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TARGETDATASOURCE    = <span class="nv">%TARGETDATASOURCE%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> SCRIPTLOCATION      = <span class="nv">%SCRIPTLOCATION%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> BACKUP              = <span class="nv">%BACKUPLOCATION%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TIMEOUT             = <span class="nv">%TIMEOUT%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> RS                  = <span class="nv">%RS%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
 
<span class="p">:</span><span class="c1">:Run Scripts</span>
 
 
<span class="k">ECHO</span> Running script <span class="s2">&#34;</span><span class="nv">%SCRIPTLOCATION%</span><span class="s2">&#34;</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="nv">%RS%</span> -i <span class="s2">&#34;</span><span class="nv">%SCRIPTLOCATION%</span><span class="s2">&#34;</span> -s <span class="nv">%REPORTSERVER%</span> -l <span class="nv">%TIMEOUT%</span> -v BACKUPLOCATION=<span class="s2">&#34;</span><span class="nv">%BACKUPLOCATION%</span><span class="s2">&#34;</span> -v vSOURCEREPORTFOLDER=<span class="s2">&#34;</span><span class="nv">%SOURCEREPORTFOLDER%</span><span class="s2">&#34;</span> -v vTARGETRSFOLDER=<span class="s2">&#34;</span><span class="nv">%TARGETRSFOLDER%</span><span class="s2">&#34;</span> -v vTARGETDATASOURCE=<span class="s2">&#34;</span><span class="nv">%TARGETDATASOURCE%</span><span class="s2">&#34;</span> -v vORIGINALDATASOURCE=<span class="s2">&#34;</span><span class="nv">%ORIGINALDATASOOURCE%</span><span class="s2">&#34;</span><span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span> <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
 
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Finished Load at <span class="nv">%DATE%</span> <span class="nv">%TIME%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
</code></pre></div><h2 id="deployreportsrss">DeployReports.rss</h2>
<div class="highlight"><pre class="chroma"><code class="language-vb" data-lang="vb"><span class="c">&#39; Script to publish reports from a local folder, 
</span><span class="c">&#39; keeping the folder structure in RS as the local folder
</span><span class="c">&#39;
</span><span class="c">&#39;&#39;&#39;&#39; Common folder path and data source for all reports
</span><span class="c">&#39;&#39;&#39;&#39; Target folder and datasource must be configured 
</span><span class="c">&#39;&#39;&#39;&#39; before publishing any reports
</span><span class="c"></span> 
<span class="c">&#39;Where are the reports you want to publish located?
</span><span class="c"></span><span class="k">Dim</span> <span class="n">SourceReportFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vSOURCEREPORTFOLDER</span>
<span class="c">&#39; Into what folder in RS do you want the reports to be published? 
</span><span class="c"></span><span class="k">Dim</span> <span class="n">TargetRSFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vTARGETRSFOLDER</span> 
<span class="c">&#39;Which datasource should the reports use? 
</span><span class="c">&#39;Must have been created before deploying!
</span><span class="c"></span><span class="k">Dim</span> <span class="n">TargetDataSource</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">VTARGETDATASOURCE</span> 
<span class="c">&#39;What is the original datasource of the reports when developing? 
</span><span class="c">&#39;Should not change that often.
</span><span class="c"></span><span class="k">Dim</span> <span class="n">OriginalReportDataSource</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vORIGINALDATASOURCE</span> 
 
 
<span class="c">&#39;&#39;&#39;&#39; Below this line is static variables and should 
</span><span class="c">&#39;&#39;&#39;&#39; not be touched when publishing reports
</span><span class="c">&#39;Debug help
</span><span class="c"></span><span class="k">Dim</span> <span class="n">SupressWarnings</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
<span class="k">Dim</span> <span class="n">DebugComments</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">True</span>
<span class="c">&#39;Other variables
</span><span class="c"></span><span class="k">Dim</span> <span class="n">sFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">SourceReportFolder</span>
<span class="k">Dim</span> <span class="n">di</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DirectoryInfo</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">)</span>
<span class="k">Dim</span> <span class="n">DirectoryFolders</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">di</span><span class="p">.</span><span class="n">GetDirectories</span><span class="p">()</span>
<span class="k">Dim</span> <span class="n">FilesFoundInFolder</span> <span class="ow">As</span> <span class="n">FileInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">di</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
<span class="k">Dim</span> <span class="n">Folder</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span>
<span class="k">Dim</span> <span class="n">CurrentSourceDir</span> <span class="ow">AS</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">SourceReportFolder</span> 
<span class="k">Dim</span> <span class="n">CurrentTargetDir</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">TargetRSFolder</span>
<span class="k">Dim</span> <span class="n">TotalNumberOfReports</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
<span class="k">Dim</span> <span class="n">TotalNumberOfFolders</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
 
<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Main</span><span class="p">()</span>
 
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Target folder: /&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Target datasource: /&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span><span class="p">)</span>
 
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Processing source folder: &#34;</span> <span class="o">+</span> <span class="n">SourceReportFolder</span><span class="p">)</span>
    <span class="n">PubReportsAndFolders</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Reports published: &#34;</span> <span class="o">&amp;</span> <span class="n">TotalNumberOfReports</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Subfolders: &#34;</span> <span class="o">&amp;</span> <span class="n">TotalNumberOfFolders</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
 
<span class="k">End</span> <span class="k">Sub</span>
 
 
 
<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PubReportsAndFolders</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">FolderToParse</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
    <span class="n">CurrentSourceDir</span> <span class="o">=</span> <span class="n">FolderToParse</span>
    <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
    <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">CurrentTargetDir</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\&#34;</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="n">ParsedFolder</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DirectoryInfo</span><span class="p">(</span><span class="n">CurrentSourceDir</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="n">DirectoryFolders</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetDirectories</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">DirectoryFiles</span> <span class="ow">As</span> <span class="n">FileInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">Folder</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span>
    <span class="k">Dim</span> <span class="n">FileInFolder</span> <span class="ow">As</span> <span class="n">FileInfo</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="n">FilesFoundInFolder</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
 
    <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Folder start: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span><span class="p">)</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentSourceDir: &#34;</span> <span class="o">+</span> <span class="n">CurrentSourceDir</span><span class="p">)</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentTargetDir 1: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
 
    <span class="k">For</span> <span class="k">Each</span> <span class="n">FileInFolder</span> <span class="ow">In</span> <span class="n">FilesFoundInFolder</span>
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Deploying report &#34;</span> <span class="o">+</span> <span class="n">FileInFolder</span><span class="p">.</span><span class="n">Name</span> <span class="o">+</span> <span class="s">&#34; start&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="k">Dim</span> <span class="n">TempName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">FileInFolder</span><span class="p">.</span><span class="n">Name</span>
        <span class="k">Dim</span> <span class="n">name</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">TempName</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;.rdl&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="n">location</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">CurrentSourceDir</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">TempName</span>
        <span class="k">Dim</span> <span class="n">parent</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span>
        <span class="k">Dim</span> <span class="n">varDataSourceReference</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span>
        <span class="k">Dim</span> <span class="n">fullpath</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">Dim</span> <span class="n">overwrite</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">True</span>
        <span class="k">Dim</span> <span class="n">reportContents</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="k">Dim</span> <span class="n">warnings</span> <span class="ow">As</span> <span class="n">Warning</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="k">Dim</span> <span class="n">descprop</span> <span class="ow">As</span> <span class="k">New</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">descprop</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Description&#34;</span>
        <span class="n">descprop</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&#34;&#34;</span>
        <span class="k">Dim</span> <span class="n">hiddenprop</span> <span class="ow">As</span> <span class="k">New</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">hiddenprop</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Hidden&#34;</span>
        <span class="n">hiddenprop</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&#34;False&#34;</span>
        <span class="k">Dim</span> <span class="n">props</span><span class="p">(</span><span class="n">1</span><span class="p">)</span> <span class="ow">As</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">props</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">descprop</span>
        <span class="n">props</span><span class="p">(</span><span class="n">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">hiddenprop</span>
 
        <span class="k">Dim</span> <span class="n">ReportFound</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">Dim</span> <span class="n">srcReportCond</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SearchCondition</span>
        <span class="k">With</span> <span class="n">srcReportCond</span>
            <span class="p">.</span><span class="n">Condition</span> <span class="o">=</span> <span class="n">ConditionEnum</span><span class="p">.</span><span class="n">Equals</span>
            <span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Name&#34;</span>
            <span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">End</span> <span class="k">With</span>
 
        <span class="k">Dim</span> <span class="n">srchReportResults</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="n">srchReportResults</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">FindItems</span> _
         <span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">BooleanOperatorEnum</span><span class="p">.</span><span class="n">And</span><span class="p">,</span> _
        <span class="k">New</span> <span class="n">SearchCondition</span><span class="p">()</span> <span class="p">{</span><span class="n">srcReportCond</span><span class="p">})</span>
 
        <span class="k">Dim</span> <span class="n">srchReportResult</span> <span class="ow">As</span> <span class="n">CatalogItem</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">srchReportResult</span> <span class="ow">In</span> <span class="n">srchReportResults</span>
            <span class="k">If</span> <span class="n">srchReportResult</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">ItemTypeEnum</span><span class="p">.</span><span class="n">Report</span> <span class="k">Then</span>
                <span class="n">ReportFound</span> <span class="o">=</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="k">If</span> <span class="n">ReportFound</span> <span class="o">=</span> <span class="n">0</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report NOT found: &#34;</span> <span class="o">+</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">Else</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report FOUND: &#34;</span> <span class="o">+</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Backup section start: &#34;</span> <span class="o">&amp;</span> <span class="n">fullpath</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="p">(</span><span class="n">ReportFound</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Try</span>
                <span class="k">Dim</span> <span class="n">exists</span> <span class="ow">As</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span><span class="p">()</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">GetProperties</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">)</span>
 
                <span class="k">Dim</span> <span class="n">ActualBackupLocation</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">BACKUPLOCATION</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span> <span class="o">&amp;</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\\&#34;</span><span class="p">,</span> <span class="s">&#34;\&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&#34;\&#34;</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\\&#34;</span><span class="p">,</span> <span class="s">&#34;\&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&#34;\&#34;</span> <span class="c">&#39;To always get \\ at the end
</span><span class="c"></span>                <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Actual backup location: &#34;</span> <span class="o">&amp;</span> <span class="n">ActualBackupLocation</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="k">If</span> <span class="k">Not</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ActualBackupLocation</span><span class="p">))</span> <span class="k">Then</span>
                    <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">CreateDirectory</span><span class="p">(</span><span class="n">ActualBackupLocation</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="k">Dim</span> <span class="n">fsReport</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileStream</span><span class="p">(</span><span class="n">ActualBackupLocation</span> <span class="o">+</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="n">IO</span><span class="p">.</span><span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">)</span>
                <span class="k">Dim</span> <span class="n">RepDef</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Byte</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">GetReportDefinition</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="n">fsReport</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">RepDef</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="n">RepDef</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
                <span class="n">fsReport</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
 
            <span class="k">Catch</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">SoapException</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Error : &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;ErrorCode&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34; (&#34;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;Message&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34;)&#34;</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">Try</span>
        <span class="k">Else</span>
            <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report do not exist, no backup needed.&#34;</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Backup section complete&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Try</span>
            <span class="k">Dim</span> <span class="n">stream</span> <span class="ow">As</span> <span class="n">FileStream</span> <span class="o">=</span> <span class="n">File</span><span class="p">.</span><span class="n">OpenRead</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="n">reportContents</span> <span class="o">=</span> <span class="k">New</span> <span class="o">[</span><span class="kt">Byte</span><span class="o">]</span><span class="p">(</span><span class="n">stream</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="p">{}</span>
            <span class="n">stream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="n">reportContents</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="k">CInt</span><span class="p">(</span><span class="n">stream</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span>
            <span class="n">stream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
 
            <span class="n">warnings</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">CreateReport</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">,</span> <span class="n">reportContents</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
 
            <span class="k">If</span> <span class="k">Not</span> <span class="p">(</span><span class="n">warnings</span> <span class="ow">Is</span> <span class="k">Nothing</span><span class="p">)</span> <span class="k">Then</span>
                <span class="k">Dim</span> <span class="n">warning</span> <span class="ow">As</span> <span class="n">Warning</span>
                <span class="k">For</span> <span class="k">Each</span> <span class="n">warning</span> <span class="ow">In</span> <span class="n">warnings</span>
                    <span class="k">If</span> <span class="n">SupressWarnings</span> <span class="k">Then</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="k">Else</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published with warnings&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Warning: &#34;</span> <span class="o">+</span> <span class="n">Warning</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span>
                    <span class="k">End</span> <span class="k">If</span>
                <span class="k">Next</span> <span class="n">warning</span>
            <span class="k">Else</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published successfully with no warnings&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
 
            <span class="k">Dim</span> <span class="n">DataSources</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="ow">As</span> <span class="n">DataSource</span>
 
            <span class="c">&#39;&#39; DataSourceReference &#34;DataSourceRef&#34; is the same as the name of the datasource in the report
</span><span class="c"></span>            <span class="c">&#39;&#39; DataSource &#34;DataSrs&#34; is the name of the actual deployed datasource in RS
</span><span class="c"></span> 
            <span class="k">Dim</span> <span class="n">DataSourceRef</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DataSourceReference</span>
            <span class="n">DataSourceRef</span><span class="p">.</span><span class="n">Reference</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span>
            <span class="k">Dim</span> <span class="n">DataSrs</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DataSource</span>
            <span class="n">DataSrs</span><span class="p">.</span><span class="n">Item</span> <span class="o">=</span> <span class="k">CType</span><span class="p">(</span><span class="n">DataSourceRef</span><span class="p">,</span> <span class="n">DataSourceDefinitionOrReference</span><span class="p">)</span>
            <span class="n">DataSrs</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">OriginalReportDataSource</span>
            <span class="n">DataSources</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">DataSrs</span>
            <span class="n">rs</span><span class="p">.</span><span class="n">SetItemDataSources</span><span class="p">(</span><span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">DataSources</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Datasource configured: {0}&#34;</span><span class="p">,</span> <span class="n">DataSourceRef</span><span class="p">.</span><span class="n">Reference</span><span class="p">)</span>
 
            <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;DataSrs.Name: &#34;</span> <span class="o">+</span> <span class="n">DataSrs</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Catch</span> <span class="n">Excep</span> <span class="ow">As</span> <span class="n">IOException</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Excep</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span>
        <span class="k">Catch</span> <span class="n">Excep</span> <span class="ow">As</span> <span class="n">SoapException</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Error: &#34;</span> <span class="o">+</span> <span class="n">Excep</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;ErrorCode&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34; (&#34;</span> <span class="o">+</span> <span class="n">Excep</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;Message&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34;)&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">Try</span>
        <span class="n">TotalNumberOfReports</span> <span class="o">=</span> <span class="n">TotalNumberOfReports</span> <span class="o">+</span> <span class="n">1</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="k">Next</span>
 
    <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Searching for subfolders in&#39;&#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;&#39;...&#34;</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
 
    <span class="k">For</span> <span class="k">Each</span> <span class="n">Folder</span> <span class="ow">In</span> <span class="n">DirectoryFolders</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">CurrentTargetDir</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\&#34;</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">)</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span>
        <span class="k">Dim</span> <span class="n">TargetFolderItems</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Local folder to parse: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Current target dir: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="n">TargetFolderItems</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">ListChildren</span><span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="k">False</span><span class="p">)</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentTargetDir 2: /&#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;TargetFolderItems count: &#34;</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Dim</span> <span class="n">x</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span> <span class="k">To</span> <span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Type</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span> <span class="n">i</span>
 
        <span class="k">Dim</span> <span class="n">myFolderArray</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span> <span class="k">To</span> <span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Type</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">myFolderArray</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Name</span>
                <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Name</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span> <span class="n">i</span>
 
        <span class="k">Dim</span> <span class="n">FolderFound</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">Dim</span> <span class="n">srcFolderCond</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SearchCondition</span>
        <span class="k">With</span> <span class="n">srcFolderCond</span>
            <span class="p">.</span><span class="n">Condition</span> <span class="o">=</span> <span class="n">ConditionEnum</span><span class="p">.</span><span class="n">Equals</span>
            <span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Name&#34;</span>
            <span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span>
        <span class="k">End</span> <span class="k">With</span>
 
        <span class="k">Dim</span> <span class="n">srchResults</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="n">srchResults</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">FindItems</span> _
         <span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="n">BooleanOperatorEnum</span><span class="p">.</span><span class="n">And</span><span class="p">,</span> _
        <span class="k">New</span> <span class="n">SearchCondition</span><span class="p">()</span> <span class="p">{</span><span class="n">srcFolderCond</span><span class="p">})</span>
 
        <span class="k">Dim</span> <span class="n">srchResult</span> <span class="ow">As</span> <span class="n">CatalogItem</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">srchResult</span> <span class="ow">In</span> <span class="n">srchResults</span>
            <span class="k">If</span> <span class="n">srchResult</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">ItemTypeEnum</span><span class="p">.</span><span class="n">Folder</span> <span class="k">Then</span>
                <span class="n">FolderFound</span> <span class="o">=</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>
 
        <span class="k">If</span> <span class="n">FolderFound</span> <span class="o">=</span> <span class="n">0</span> <span class="k">Then</span>
            <span class="n">rs</span><span class="p">.</span><span class="n">CreateFolder</span><span class="p">(</span><span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Created target folder: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Existing target folder found: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="n">TotalNumberOfFolders</span> <span class="o">=</span> <span class="n">TotalNumberOfFolders</span> <span class="o">+</span> <span class="n">1</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Processing source folder: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="n">PubReportsAndFolders</span><span class="p">(</span><span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
 
    <span class="k">Next</span>
 
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div><p>Since VB is not my strongest skill I am sure this can be done in a much more efficient way and the code is far from pretty, but it seems to be working as it should. I based these scripts on the output from <a href="http://www.sqldbatips.com/showarticle.asp?ID=62">Reporting Services Scripter</a>.</p>
<p>Other web sites that helped me understand how this works (I probably forgot some):</p>
<ul>
<li>TechNet: <a href="http://technet.microsoft.com/en-us/library/cc282788(v=sql.100).aspx">ReportingService2005 Class</a></li>
<li>Database <a href="http://www.databasejournal.com/features/mssql/article.php/3889376/How-to-Automate-Report-Deployment-Using-SSRS-Web-Service.htm">Journal: How to Automate Report Deployment Using SSRS Web Service</a></li>
<li>The Code Project: <a href="http://www.codeproject.com/Articles/43133/Deploying-Reports-in-Reporting-Services-Programmat">Deploying Reports in Reporting Services Programmatically</a></li>
<li>Simple-talk: <a href="http://www.simple-talk.com/sql/reporting-services/deploying-reports-using-the-reportingservices2005-class-and-the-rs-utility/">Deploying Reports using the ReportingServices2005 Class and the RS Utility</a></li>
<li>DevEx: <a href="http://www.devx.com/dotnet/Article/22014/0/page/1">Automating Smart-Client Report Deployments</a></li>
</ul>

        </div>

        
        <div class="main-content-preview">
            <h1>Dynamic deploy of SSRS reports using rs.exe</h1>
            
            <p>This script will search for reports in the local folder SOURCEREPORTFOLDER and then deploy them in the RS folder TARGETRSFOLDER, creating subfolders if needed. If any of the reports already exists in RS it will first do a backup of the existing report into the local folder BACKUPLOCATION. The target folder in RS will contain the same file structure as the source folder. Subfolders will be created if they don&rsquo;t already exists and so on. All actions are logged to a log file for each deploy.</p>
<p>This script expects only one datasource for all reports. If the datasource has a different name in the target environment than where it was developed you will get an error in the log when the report first is deployed, but the script will after that set the proper data source and it will work anyway. The reason for this is that the report expects a data source with a certain name and the script can only set the correct data source after the report has been deployed. If you are confident that the script works (after extensive testing) you can suppress these messages by setting the variable SuppressWarnings to true in the rss file but I am not sure if thats a good idea.</p>
<p>I tried to create a unique log file name for each deploy but since date and time is acting a bit weird when running batch scripts I resorted to having a random number in the end of the log file. Not pretty but it works. All you need to do to test the script is to modify the the beginning of the batch script. The variables need to be set according to your needs.</p>
<p>How to test the scripts:</p>
<ol>
<li>Save both scripts (DeployReports.cmd &amp; DeployReports.rss) into the folder of your choice. In your selected folder, create two subfolders named Reports and Log.</li>
<li>Put the reports you want to deploy into the Reports folder.</li>
<li>Create the &ldquo;root&rdquo; folder where the reports should be deployed in RS. Also create the datasource before deploying the reports.</li>
<li>Edit the bat to adapt the variables to your environment. The lines you need to edit is highlighter below.</li>
<li>Run the bat file in a command prompt, on the machine where RS is running.</li>
</ol>
<p>I added some debug features in the rss script which helped me while developing the script and if you want to turn debug on there is a variable called DebugComments which you can set to true. The scripts should work on both Reporting Services 2005 and 2008.</p>
<h2 id="deployreportscmd">DeployReports.cmd</h2>
<div class="highlight"><pre class="chroma"><code class="language-cmd" data-lang="cmd"><span class="p">@</span><span class="k">echo</span> on
<span class="p">:</span><span class="c1">: ** Script generated by Reporting Services Scripter 2.0.0.17 **</span>
<span class="p">:</span><span class="c1">: ** Created by Jasper Smith (jas@sqldbatips.com)             **</span>
<span class="p">:</span><span class="c1">: ** See http://www.sqldbatips.com for help/support           **</span>
 
<span class="p">:</span><span class="c1">:Requires Reports and Log folder to work</span>
 
<span class="p">:</span><span class="c1">:Script Variables</span>
<span class="k">SET</span> <span class="nv">SOURCEREPORTFOLDER</span><span class="p">=</span>Reports
<span class="k">SET</span> <span class="nv">ORIGINALDATASOURCE</span><span class="p">=</span>Datasource
<span class="k">SET</span> <span class="nv">REPORTSERVER</span><span class="p">=</span>http://localhost/ReportServer
<span class="k">SET</span> <span class="nv">TARGETRSFOLDER</span><span class="p">=</span>LABfolder
<span class="k">SET</span> <span class="nv">TARGETDATASOURCE</span><span class="p">=</span>Datasource
 
<span class="k">SET</span> <span class="nv">SCRIPTLOCATION</span><span class="p">=</span>DeployReports.rss
<span class="k">SET</span> <span class="nv">RS</span><span class="p">=</span><span class="s2">&#34;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\rs.exe&#34;</span>
<span class="k">SET</span> <span class="nv">TIMEOUT</span><span class="p">=</span>60
 
 
 
<span class="p">:</span><span class="c1">:Generate suffix for log and backup</span>
<span class="p">@</span><span class="k">For</span> <span class="k">/F</span> <span class="s2">&#34;tokens=1,2,3 delims=/ &#34;</span> <span class="se">%%</span>A <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;Date /t&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">@(</span> 
<span class="k">Set</span> <span class="nv">Day</span><span class="p">=</span><span class="se">%%</span>A
<span class="k">Set</span> <span class="nv">Month</span><span class="p">=</span><span class="se">%%</span>B
<span class="k">Set</span> <span class="nv">Year</span><span class="p">=</span><span class="se">%%</span>C
<span class="k">Set</span> <span class="nv">Dat</span><span class="p">=</span><span class="se">%%</span>C<span class="se">%%</span>B<span class="se">%%</span>A
<span class="p">)</span>
<span class="p">@</span><span class="k">For</span> <span class="k">/F</span> <span class="s2">&#34;tokens=1,2 delims=: &#34;</span> <span class="se">%%</span>A <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;time /t&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="p">@(</span> 
<span class="k">Set</span> <span class="nv">Hour</span><span class="p">=</span><span class="se">%%</span>A
<span class="k">Set</span> <span class="nv">Minute</span><span class="p">=</span><span class="se">%%</span>B
<span class="k">Set</span> <span class="nv">tim</span><span class="p">=</span><span class="se">%%</span>A<span class="se">%%</span>B_r<span class="nv">%random%</span>
<span class="p">)</span>
 
<span class="k">SET</span> <span class="nv">LOGFILE</span><span class="p">=</span><span class="s2">&#34;log\DeployReports_</span><span class="nv">%dat%</span><span class="s2">_</span><span class="nv">%tim%</span><span class="s2">.log&#34;</span>
<span class="k">SET</span> <span class="nv">BACKUPLOCATION</span><span class="p">=</span>Backup\Bak_<span class="nv">%dat%</span>_<span class="nv">%tim%</span>\\
 
<span class="p">:</span><span class="c1">:Write Log Header</span>
<span class="k">ECHO</span> Reporting Services Scripter Load Log 2.0.0.17 <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Starting Load at <span class="nv">%DATE%</span> <span class="nv">%TIME%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Variables:
<span class="k">ECHO</span> SOURCEREPORTFOLDER  = <span class="nv">%SOURCEREPORTFOLDER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> ORIGINALDATASOOURCE = <span class="nv">%ORIGINALDATASOURCE%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> REPORTSERVER        = <span class="nv">%REPORTSERVER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TARGETRSFOLDER      = <span class="nv">%TARGETRSFOLDER%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TARGETDATASOURCE    = <span class="nv">%TARGETDATASOURCE%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> SCRIPTLOCATION      = <span class="nv">%SCRIPTLOCATION%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> BACKUP              = <span class="nv">%BACKUPLOCATION%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> TIMEOUT             = <span class="nv">%TIMEOUT%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> RS                  = <span class="nv">%RS%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
 
<span class="p">:</span><span class="c1">:Run Scripts</span>
 
 
<span class="k">ECHO</span> Running script <span class="s2">&#34;</span><span class="nv">%SCRIPTLOCATION%</span><span class="s2">&#34;</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="nv">%RS%</span> -i <span class="s2">&#34;</span><span class="nv">%SCRIPTLOCATION%</span><span class="s2">&#34;</span> -s <span class="nv">%REPORTSERVER%</span> -l <span class="nv">%TIMEOUT%</span> -v BACKUPLOCATION=<span class="s2">&#34;</span><span class="nv">%BACKUPLOCATION%</span><span class="s2">&#34;</span> -v vSOURCEREPORTFOLDER=<span class="s2">&#34;</span><span class="nv">%SOURCEREPORTFOLDER%</span><span class="s2">&#34;</span> -v vTARGETRSFOLDER=<span class="s2">&#34;</span><span class="nv">%TARGETRSFOLDER%</span><span class="s2">&#34;</span> -v vTARGETDATASOURCE=<span class="s2">&#34;</span><span class="nv">%TARGETDATASOURCE%</span><span class="s2">&#34;</span> -v vORIGINALDATASOURCE=<span class="s2">&#34;</span><span class="nv">%ORIGINALDATASOOURCE%</span><span class="s2">&#34;</span><span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span> <span class="mi">2</span><span class="p">&gt;&amp;</span><span class="mi">1</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
 
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span> Finished Load at <span class="nv">%DATE%</span> <span class="nv">%TIME%</span> <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
<span class="k">ECHO</span>. <span class="p">&gt;&gt;</span><span class="nv">%LOGFILE%</span>
</code></pre></div><h2 id="deployreportsrss">DeployReports.rss</h2>
<div class="highlight"><pre class="chroma"><code class="language-vb" data-lang="vb"><span class="c">&#39; Script to publish reports from a local folder, 
</span><span class="c">&#39; keeping the folder structure in RS as the local folder
</span><span class="c">&#39;
</span><span class="c">&#39;&#39;&#39;&#39; Common folder path and data source for all reports
</span><span class="c">&#39;&#39;&#39;&#39; Target folder and datasource must be configured 
</span><span class="c">&#39;&#39;&#39;&#39; before publishing any reports
</span><span class="c"></span> 
<span class="c">&#39;Where are the reports you want to publish located?
</span><span class="c"></span><span class="k">Dim</span> <span class="n">SourceReportFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vSOURCEREPORTFOLDER</span>
<span class="c">&#39; Into what folder in RS do you want the reports to be published? 
</span><span class="c"></span><span class="k">Dim</span> <span class="n">TargetRSFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vTARGETRSFOLDER</span> 
<span class="c">&#39;Which datasource should the reports use? 
</span><span class="c">&#39;Must have been created before deploying!
</span><span class="c"></span><span class="k">Dim</span> <span class="n">TargetDataSource</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">VTARGETDATASOURCE</span> 
<span class="c">&#39;What is the original datasource of the reports when developing? 
</span><span class="c">&#39;Should not change that often.
</span><span class="c"></span><span class="k">Dim</span> <span class="n">OriginalReportDataSource</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">vORIGINALDATASOURCE</span> 
 
 
<span class="c">&#39;&#39;&#39;&#39; Below this line is static variables and should 
</span><span class="c">&#39;&#39;&#39;&#39; not be touched when publishing reports
</span><span class="c">&#39;Debug help
</span><span class="c"></span><span class="k">Dim</span> <span class="n">SupressWarnings</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">False</span>
<span class="k">Dim</span> <span class="n">DebugComments</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">True</span>
<span class="c">&#39;Other variables
</span><span class="c"></span><span class="k">Dim</span> <span class="n">sFolder</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">SourceReportFolder</span>
<span class="k">Dim</span> <span class="n">di</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DirectoryInfo</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">)</span>
<span class="k">Dim</span> <span class="n">DirectoryFolders</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">di</span><span class="p">.</span><span class="n">GetDirectories</span><span class="p">()</span>
<span class="k">Dim</span> <span class="n">FilesFoundInFolder</span> <span class="ow">As</span> <span class="n">FileInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">di</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
<span class="k">Dim</span> <span class="n">Folder</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span>
<span class="k">Dim</span> <span class="n">CurrentSourceDir</span> <span class="ow">AS</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">SourceReportFolder</span> 
<span class="k">Dim</span> <span class="n">CurrentTargetDir</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">TargetRSFolder</span>
<span class="k">Dim</span> <span class="n">TotalNumberOfReports</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
<span class="k">Dim</span> <span class="n">TotalNumberOfFolders</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
 
<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Main</span><span class="p">()</span>
 
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Target folder: /&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Target datasource: /&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span><span class="p">)</span>
 
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Processing source folder: &#34;</span> <span class="o">+</span> <span class="n">SourceReportFolder</span><span class="p">)</span>
    <span class="n">PubReportsAndFolders</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Reports published: &#34;</span> <span class="o">&amp;</span> <span class="n">TotalNumberOfReports</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Subfolders: &#34;</span> <span class="o">&amp;</span> <span class="n">TotalNumberOfFolders</span><span class="p">)</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">()</span>
 
<span class="k">End</span> <span class="k">Sub</span>
 
 
 
<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PubReportsAndFolders</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">FolderToParse</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span>
    <span class="n">CurrentSourceDir</span> <span class="o">=</span> <span class="n">FolderToParse</span>
    <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
    <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">CurrentTargetDir</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\&#34;</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="n">ParsedFolder</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DirectoryInfo</span><span class="p">(</span><span class="n">CurrentSourceDir</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="n">DirectoryFolders</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetDirectories</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">DirectoryFiles</span> <span class="ow">As</span> <span class="n">FileInfo</span><span class="p">()</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">Folder</span> <span class="ow">As</span> <span class="n">DirectoryInfo</span>
    <span class="k">Dim</span> <span class="n">FileInFolder</span> <span class="ow">As</span> <span class="n">FileInfo</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="n">FilesFoundInFolder</span> <span class="o">=</span> <span class="n">ParsedFolder</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">()</span>
 
    <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Folder start: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span><span class="p">)</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentSourceDir: &#34;</span> <span class="o">+</span> <span class="n">CurrentSourceDir</span><span class="p">)</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentTargetDir 1: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
 
    <span class="k">For</span> <span class="k">Each</span> <span class="n">FileInFolder</span> <span class="ow">In</span> <span class="n">FilesFoundInFolder</span>
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Deploying report &#34;</span> <span class="o">+</span> <span class="n">FileInFolder</span><span class="p">.</span><span class="n">Name</span> <span class="o">+</span> <span class="s">&#34; start&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="k">Dim</span> <span class="n">TempName</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">FileInFolder</span><span class="p">.</span><span class="n">Name</span>
        <span class="k">Dim</span> <span class="n">name</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">TempName</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;.rdl&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="n">location</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">CurrentSourceDir</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">TempName</span>
        <span class="k">Dim</span> <span class="n">parent</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span>
        <span class="k">Dim</span> <span class="n">varDataSourceReference</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span>
        <span class="k">Dim</span> <span class="n">fullpath</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">Dim</span> <span class="n">overwrite</span> <span class="ow">As</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="k">True</span>
        <span class="k">Dim</span> <span class="n">reportContents</span> <span class="ow">As</span> <span class="kt">Byte</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="k">Dim</span> <span class="n">warnings</span> <span class="ow">As</span> <span class="n">Warning</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="k">Dim</span> <span class="n">descprop</span> <span class="ow">As</span> <span class="k">New</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">descprop</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Description&#34;</span>
        <span class="n">descprop</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&#34;&#34;</span>
        <span class="k">Dim</span> <span class="n">hiddenprop</span> <span class="ow">As</span> <span class="k">New</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">hiddenprop</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Hidden&#34;</span>
        <span class="n">hiddenprop</span><span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&#34;False&#34;</span>
        <span class="k">Dim</span> <span class="n">props</span><span class="p">(</span><span class="n">1</span><span class="p">)</span> <span class="ow">As</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span>
        <span class="n">props</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">descprop</span>
        <span class="n">props</span><span class="p">(</span><span class="n">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">hiddenprop</span>
 
        <span class="k">Dim</span> <span class="n">ReportFound</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">Dim</span> <span class="n">srcReportCond</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SearchCondition</span>
        <span class="k">With</span> <span class="n">srcReportCond</span>
            <span class="p">.</span><span class="n">Condition</span> <span class="o">=</span> <span class="n">ConditionEnum</span><span class="p">.</span><span class="n">Equals</span>
            <span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Name&#34;</span>
            <span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">End</span> <span class="k">With</span>
 
        <span class="k">Dim</span> <span class="n">srchReportResults</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="n">srchReportResults</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">FindItems</span> _
         <span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">BooleanOperatorEnum</span><span class="p">.</span><span class="n">And</span><span class="p">,</span> _
        <span class="k">New</span> <span class="n">SearchCondition</span><span class="p">()</span> <span class="p">{</span><span class="n">srcReportCond</span><span class="p">})</span>
 
        <span class="k">Dim</span> <span class="n">srchReportResult</span> <span class="ow">As</span> <span class="n">CatalogItem</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">srchReportResult</span> <span class="ow">In</span> <span class="n">srchReportResults</span>
            <span class="k">If</span> <span class="n">srchReportResult</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">ItemTypeEnum</span><span class="p">.</span><span class="n">Report</span> <span class="k">Then</span>
                <span class="n">ReportFound</span> <span class="o">=</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="k">If</span> <span class="n">ReportFound</span> <span class="o">=</span> <span class="n">0</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report NOT found: &#34;</span> <span class="o">+</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">Else</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report FOUND: &#34;</span> <span class="o">+</span> <span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Backup section start: &#34;</span> <span class="o">&amp;</span> <span class="n">fullpath</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="p">(</span><span class="n">ReportFound</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Try</span>
                <span class="k">Dim</span> <span class="n">exists</span> <span class="ow">As</span> <span class="o">[</span><span class="n">Property</span><span class="o">]</span><span class="p">()</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">GetProperties</span><span class="p">(</span><span class="n">fullpath</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">)</span>
 
                <span class="k">Dim</span> <span class="n">ActualBackupLocation</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">BACKUPLOCATION</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span> <span class="o">&amp;</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\\&#34;</span><span class="p">,</span> <span class="s">&#34;\&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&#34;\&#34;</span>
                <span class="n">ActualBackupLocation</span> <span class="o">=</span> <span class="n">ActualBackupLocation</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\\&#34;</span><span class="p">,</span> <span class="s">&#34;\&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&#34;\&#34;</span> <span class="c">&#39;To always get \\ at the end
</span><span class="c"></span>                <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Actual backup location: &#34;</span> <span class="o">&amp;</span> <span class="n">ActualBackupLocation</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="k">If</span> <span class="k">Not</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">ActualBackupLocation</span><span class="p">))</span> <span class="k">Then</span>
                    <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">CreateDirectory</span><span class="p">(</span><span class="n">ActualBackupLocation</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="k">Dim</span> <span class="n">fsReport</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileStream</span><span class="p">(</span><span class="n">ActualBackupLocation</span> <span class="o">+</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">location</span><span class="p">),</span> <span class="n">IO</span><span class="p">.</span><span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">)</span>
                <span class="k">Dim</span> <span class="n">RepDef</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Byte</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">GetReportDefinition</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="n">fsReport</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">RepDef</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="n">RepDef</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
                <span class="n">fsReport</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
 
            <span class="k">Catch</span> <span class="n">e</span> <span class="ow">As</span> <span class="n">SoapException</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Error : &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;ErrorCode&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34; (&#34;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;Message&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34;)&#34;</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">Try</span>
        <span class="k">Else</span>
            <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Report do not exist, no backup needed.&#34;</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Backup section complete&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Try</span>
            <span class="k">Dim</span> <span class="n">stream</span> <span class="ow">As</span> <span class="n">FileStream</span> <span class="o">=</span> <span class="n">File</span><span class="p">.</span><span class="n">OpenRead</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="n">reportContents</span> <span class="o">=</span> <span class="k">New</span> <span class="o">[</span><span class="kt">Byte</span><span class="o">]</span><span class="p">(</span><span class="n">stream</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="p">{}</span>
            <span class="n">stream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="n">reportContents</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="k">CInt</span><span class="p">(</span><span class="n">stream</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span>
            <span class="n">stream</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
 
            <span class="n">warnings</span> <span class="o">=</span> <span class="n">RS</span><span class="p">.</span><span class="n">CreateReport</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">,</span> <span class="n">reportContents</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
 
            <span class="k">If</span> <span class="k">Not</span> <span class="p">(</span><span class="n">warnings</span> <span class="ow">Is</span> <span class="k">Nothing</span><span class="p">)</span> <span class="k">Then</span>
                <span class="k">Dim</span> <span class="n">warning</span> <span class="ow">As</span> <span class="n">Warning</span>
                <span class="k">For</span> <span class="k">Each</span> <span class="n">warning</span> <span class="ow">In</span> <span class="n">warnings</span>
                    <span class="k">If</span> <span class="n">SupressWarnings</span> <span class="k">Then</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="k">Else</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published with warnings&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Warning: &#34;</span> <span class="o">+</span> <span class="n">Warning</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span>
                    <span class="k">End</span> <span class="k">If</span>
                <span class="k">Next</span> <span class="n">warning</span>
            <span class="k">Else</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Report &#34;&#34;{0}&#34;&#34; published successfully with no warnings&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
 
            <span class="k">Dim</span> <span class="n">DataSources</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="ow">As</span> <span class="n">DataSource</span>
 
            <span class="c">&#39;&#39; DataSourceReference &#34;DataSourceRef&#34; is the same as the name of the datasource in the report
</span><span class="c"></span>            <span class="c">&#39;&#39; DataSource &#34;DataSrs&#34; is the name of the actual deployed datasource in RS
</span><span class="c"></span> 
            <span class="k">Dim</span> <span class="n">DataSourceRef</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DataSourceReference</span>
            <span class="n">DataSourceRef</span><span class="p">.</span><span class="n">Reference</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetDataSource</span>
            <span class="k">Dim</span> <span class="n">DataSrs</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">DataSource</span>
            <span class="n">DataSrs</span><span class="p">.</span><span class="n">Item</span> <span class="o">=</span> <span class="k">CType</span><span class="p">(</span><span class="n">DataSourceRef</span><span class="p">,</span> <span class="n">DataSourceDefinitionOrReference</span><span class="p">)</span>
            <span class="n">DataSrs</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">OriginalReportDataSource</span>
            <span class="n">DataSources</span><span class="p">(</span><span class="n">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">DataSrs</span>
            <span class="n">rs</span><span class="p">.</span><span class="n">SetItemDataSources</span><span class="p">(</span><span class="n">parent</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">DataSources</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Datasource configured: {0}&#34;</span><span class="p">,</span> <span class="n">DataSourceRef</span><span class="p">.</span><span class="n">Reference</span><span class="p">)</span>
 
            <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;DataSrs.Name: &#34;</span> <span class="o">+</span> <span class="n">DataSrs</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
            <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Catch</span> <span class="n">Excep</span> <span class="ow">As</span> <span class="n">IOException</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">Excep</span><span class="p">.</span><span class="n">Message</span><span class="p">)</span>
        <span class="k">Catch</span> <span class="n">Excep</span> <span class="ow">As</span> <span class="n">SoapException</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;Error: &#34;</span> <span class="o">+</span> <span class="n">Excep</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;ErrorCode&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34; (&#34;</span> <span class="o">+</span> <span class="n">Excep</span><span class="p">.</span><span class="n">Detail</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&#34;Message&#34;</span><span class="p">).</span><span class="n">InnerText</span> <span class="o">+</span> <span class="s">&#34;)&#34;</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">Try</span>
        <span class="n">TotalNumberOfReports</span> <span class="o">=</span> <span class="n">TotalNumberOfReports</span> <span class="o">+</span> <span class="n">1</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="k">Next</span>
 
    <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Searching for subfolders in&#39;&#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;&#39;...&#34;</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
 
    <span class="k">For</span> <span class="k">Each</span> <span class="n">Folder</span> <span class="ow">In</span> <span class="n">DirectoryFolders</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">FolderToParse</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">SourceReportFolder</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="n">CurrentTargetDir</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s">&#34;\&#34;</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">)</span>
        <span class="n">CurrentTargetDir</span> <span class="o">=</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">TargetRSFolder</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span>
        <span class="k">Dim</span> <span class="n">TargetFolderItems</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Local folder to parse: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Current target dir: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="n">TargetFolderItems</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">ListChildren</span><span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="k">False</span><span class="p">)</span>
 
        <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;CurrentTargetDir 2: /&#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;TargetFolderItems count: &#34;</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="k">Dim</span> <span class="n">x</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span> <span class="k">To</span> <span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Type</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span> <span class="n">i</span>
 
        <span class="k">Dim</span> <span class="n">myFolderArray</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
        <span class="k">For</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span> <span class="k">To</span> <span class="n">TargetFolderItems</span><span class="p">.</span><span class="n">Length</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Type</span> <span class="o">=</span> <span class="n">1</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">myFolderArray</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Name</span>
                <span class="k">If</span> <span class="n">DebugComments</span> <span class="k">Then</span>
                    <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="n">TargetFolderItems</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Name</span><span class="p">)</span>
                <span class="k">End</span> <span class="k">If</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span> <span class="n">i</span>
 
        <span class="k">Dim</span> <span class="n">FolderFound</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">Dim</span> <span class="n">srcFolderCond</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">SearchCondition</span>
        <span class="k">With</span> <span class="n">srcFolderCond</span>
            <span class="p">.</span><span class="n">Condition</span> <span class="o">=</span> <span class="n">ConditionEnum</span><span class="p">.</span><span class="n">Equals</span>
            <span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#34;Name&#34;</span>
            <span class="p">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span>
        <span class="k">End</span> <span class="k">With</span>
 
        <span class="k">Dim</span> <span class="n">srchResults</span> <span class="ow">As</span> <span class="n">CatalogItem</span><span class="p">()</span> <span class="o">=</span> <span class="k">Nothing</span>
        <span class="n">srchResults</span> <span class="o">=</span> <span class="n">rs</span><span class="p">.</span><span class="n">FindItems</span> _
         <span class="p">(</span><span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="n">BooleanOperatorEnum</span><span class="p">.</span><span class="n">And</span><span class="p">,</span> _
        <span class="k">New</span> <span class="n">SearchCondition</span><span class="p">()</span> <span class="p">{</span><span class="n">srcFolderCond</span><span class="p">})</span>
 
        <span class="k">Dim</span> <span class="n">srchResult</span> <span class="ow">As</span> <span class="n">CatalogItem</span>
        <span class="k">For</span> <span class="k">Each</span> <span class="n">srchResult</span> <span class="ow">In</span> <span class="n">srchResults</span>
            <span class="k">If</span> <span class="n">srchResult</span><span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">ItemTypeEnum</span><span class="p">.</span><span class="n">Folder</span> <span class="k">Then</span>
                <span class="n">FolderFound</span> <span class="o">=</span> <span class="n">1</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Next</span>
 
        <span class="k">If</span> <span class="n">FolderFound</span> <span class="o">=</span> <span class="n">0</span> <span class="k">Then</span>
            <span class="n">rs</span><span class="p">.</span><span class="n">CreateFolder</span><span class="p">(</span><span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">CurrentTargetDir</span><span class="p">,</span> <span class="k">Nothing</span><span class="p">)</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Created target folder: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Existing target folder found: &#34;</span> <span class="o">+</span> <span class="n">CurrentTargetDir</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
 
        <span class="n">TotalNumberOfFolders</span> <span class="o">=</span> <span class="n">TotalNumberOfFolders</span> <span class="o">+</span> <span class="n">1</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">Writeline</span><span class="p">(</span><span class="s">&#34;Processing source folder: &#34;</span> <span class="o">+</span> <span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
        <span class="n">PubReportsAndFolders</span><span class="p">(</span><span class="n">FolderToParse</span> <span class="o">+</span> <span class="s">&#34;\&#34;</span> <span class="o">+</span> <span class="n">Folder</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
 
    <span class="k">Next</span>
 
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div><p>Since VB is not my strongest skill I am sure this can be done in a much more efficient way and the code is far from pretty, but it seems to be working as it should. I based these scripts on the output from <a href="http://www.sqldbatips.com/showarticle.asp?ID=62">Reporting Services Scripter</a>.</p>
<p>Other web sites that helped me understand how this works (I probably forgot some):</p>
<ul>
<li>TechNet: <a href="http://technet.microsoft.com/en-us/library/cc282788(v=sql.100).aspx">ReportingService2005 Class</a></li>
<li>Database <a href="http://www.databasejournal.com/features/mssql/article.php/3889376/How-to-Automate-Report-Deployment-Using-SSRS-Web-Service.htm">Journal: How to Automate Report Deployment Using SSRS Web Service</a></li>
<li>The Code Project: <a href="http://www.codeproject.com/Articles/43133/Deploying-Reports-in-Reporting-Services-Programmat">Deploying Reports in Reporting Services Programmatically</a></li>
<li>Simple-talk: <a href="http://www.simple-talk.com/sql/reporting-services/deploying-reports-using-the-reportingservices2005-class-and-the-rs-utility/">Deploying Reports using the ReportingServices2005 Class and the RS Utility</a></li>
<li>DevEx: <a href="http://www.devx.com/dotnet/Article/22014/0/page/1">Automating Smart-Client Report Deployments</a></li>
</ul>


            <p>- Written by John  
            
                
                
                on March 1, 2012</p>

            
                <div class="disqus-section">
                    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "blog-roostech-se" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                </div>
            
        </div>

    </div>
    


            </div>
        </div>
    </body>
</html>
