<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    
    
    <title>Classes in Powershell 5.0</title>
    <meta name="description" content="One of the big new features in Powershell 5.0 is classes. You can now define your own classes and create objects based on those custom classes. You can even create your own version of an existing class using inheritance.
In previous version of Powershell it was actually possible to create classes, but you had to write code in other languages like C# or Visual basic and then use that piece of code as the definition of the class."/>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-35019756-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle" checked>
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><span class="rotate-letter">></span><span class="menu-item"><a class="menu-item-site" href="http://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></span>
            <ul>  
                <li><span class="rotate-letter">></span><span class="menu-item">content</span>
                    <ul>
                        <li><span class="rotate-letter">></span><span class="menu-item">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li class="current"><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li ><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="rotate-letter">></span><span class="menu-item">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                                <li ><a href="/gists/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Gists.md</span></a></li>
                                
                                <li ><a href="/parameter-validation/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Parameter Validation.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>><span class="menu-item">data</span></li>
                <li>><span class="menu-item">layouts</span></li>
                <li>><span class="menu-item">resources</span></li>
                <li>><span class="menu-item">static</span></li>
                <li>><span class="menu-item">themes</span></li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV><div class='main'>
     
     
     
    
     
    
     
    
     
    
     
    
    
        
        <div class="main-tabs">
            <div class="main-tabs-scroll">
                <div class="main-tabs-table">
                    <div class ="main-tabs-row">
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                        </div>
                    
                        <div class="main-tab current">
                            <span class="rotate-letter md-icon">&#10144;</span> <i>Classes in Powershell 5.0.md</i> 
                        </div>
                    
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/pester-5-discovery-and-testcases/">Pester 5: Discovery and TestCases.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/create-and-use-azure-table-storage-with-powershell/">Create and use Azure Table storage with PowerShell.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/">Use Edit-Command to discover the code behind built-in cmdlets.md</a>
                        </div>
                    
                    </div>
                </div>
            </div>
        </div>
        <div class="main-path">
            <a class="path-link" href="http://blog.roostech.se/">blog.roostech.se</a> > content > posts &gt; Classes in Powershell 5.0.md
        </div>
        <div class="main-content-toggle">

            
            <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
            <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

            <input class="source-toggle" type="checkbox" id="source-toggle">
            <label class="source-toggle-label" for="source-toggle"></label>

            <div class="main-content">
                ---<br />
                <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">Classes in Powershell 5.0</span><br />
                <span class="md-frontmatter">date</span>: 2015-03-01 14:14:00 &#43;0200 &#43;0200<br />
                <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
                <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John</span><br />
                ----
                <p>One of the big new features in Powershell 5.0 is classes. You can now define your own classes and create objects based on those custom classes. You can even create your own version of an existing class using inheritance.</p>
<p>In previous version of Powershell it was actually possible to create classes, but you had to write code in other languages like C# or Visual basic and then use that piece of code as the definition of the class. Now this is much easier.</p>
<p>Lets get right into the code. In these examples I will create a class which contains two properties: ComputerName and Domain. Both will be simple strings. Further down I will add some methods to the class and show some examples on how to use those methods.</p>
<p>First lets look at how we had to create classes before Powershell 5.</p>
<h2 id="create-class-with-c">Create class with C#</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with C sharp</span>
<span class="nv">$ComputerTypeCsharp</span> <span class="p">=</span> <span class="p">@</span><span class="err">”</span>
    <span class="n">public</span> <span class="n">class</span> <span class="n">ComputerCsharp</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">ComputerName</span> <span class="p">{</span><span class="n">get</span><span class="p">;</span> <span class="n">set</span><span class="p">;}</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">Domain</span> <span class="p">{</span><span class="n">get</span><span class="p">;</span> <span class="n">set</span><span class="p">;}</span>
    <span class="p">}</span>
<span class="err">“</span><span class="p">@</span>

<span class="nb">Add-Type</span> <span class="n">-TypeDefinition</span> <span class="nv">$ComputerTypeCsharp</span> <span class="n">-Language</span> <span class="n">CSharpVersion3</span>
 
<span class="nv">$x1</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">ComputerCsharp</span>
<span class="nv">$x1</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span>
<span class="nv">$x1</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x1</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</code></pre></div><h2 id="create-class-with-visual-basic">Create class with Visual Basic</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with Visual Basic</span>
<span class="nv">$ComputerTypeVB</span> <span class="p">=</span> <span class="p">@</span><span class="err">”</span>
    <span class="n">Public</span> <span class="n">Class</span> <span class="n">ComputerVB</span>
        <span class="n">Public</span> <span class="n">ComputerName</span> <span class="n">As</span> <span class="n">String</span>
        <span class="n">Public</span> <span class="n">Domain</span> <span class="n">As</span> <span class="n">String</span>
    <span class="k">End</span> <span class="n">Class</span>
<span class="s2">&#34;@
</span><span class="s2">
</span><span class="s2">Add-Type -TypeDefinition $ComputerTypeVB -Language VisualBasic
</span><span class="s2"> 
</span><span class="s2">$x2 = New-Object -TypeName ComputerVB
</span><span class="s2">$x2.ComputerName = &#39;Server01&#39;
</span><span class="s2">$x2.Domain = &#39;domain.com&#39;
</span><span class="s2">$x2 | Get-Member
</span></code></pre></div><p>Thats fine for simple classes, but when they become more complex its not very easy to read since the whole definition is just one long string with no highlights and syntax which is quite different from Powershell.</p>
<h2 id="powershell-classes">PowerShell classes</h2>
<p>Now lets create the same class, but with Powershell. The syntax for creating a class is straight forward:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">class</span> <span class="n">ComputerPS</span> 
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
<span class="p">}</span>
</code></pre></div><p>To create an object using this class we can use [ComputerPS]::new() and assign that to a variable. Then add the ComputerName and Domain strings. Pipe the variable to Get-Member for further inspection.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with Powershell</span>
<span class="n">class</span> <span class="n">ComputerPS</span> 
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
<span class="p">}</span>
<span class="c"># Create a new variable based on the class</span>
<span class="nv">$x3</span> <span class="p">=</span> <span class="no">[ComputerPS]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="c"># Add a computername</span>
<span class="nv">$x3</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="c"># Add a domain name</span>
<span class="nv">$x3</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="c"># Pipe to Get-Member for inspection</span>
<span class="nv">$x3</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</code></pre></div><h2 id="powershell-classes-with-methods">PowerShell classes with methods</h2>
<p>So now we can add ComputerName and Domain to the object. What if we want to create a method?
Methods are declared like functions within the class. As of the february release of Powershell 5.0, if a method needs to access variables from outside of the method but within the class then you need to add $this before the variable as you can see in the example below. The method added in this example simply merges the strings together to get a fully qualified domain name, but only if ComputerName and Domain contains text.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Powershell class with overloaded methods</span>
<span class="n">class</span> <span class="n">ComputerPSwithMethodOverload</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="c"># Create a method to return fully qualified domain name</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x4</span> <span class="p">=</span> <span class="no">[ComputerPSwithMethodOverload]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x4</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Call the method to get FQDN</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
</code></pre></div><h2 id="powershell-classes-with-overloaded-methods">PowerShell classes with overloaded methods</h2>
<p>You can also create overloaded methods. An overloaded method is a method with the same name as another method but in a different context, in this case with different parameters. In this way the method can be called either without parameters or with two parameters. Powershell will try to match with the most appropriate method depending on how many parameters you use. In this example I add two parameters so that we can create a FQDN for any servers, not just the ones in the current object.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Powershell class with overloaded methods</span>
<span class="n">class</span> <span class="n">ComputerPSwithMethodOverload</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c"># Create another method with the same name, but with different parameters</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="no">[string]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$ComputerName.$Domain&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x4</span> <span class="p">=</span> <span class="no">[ComputerPSwithMethodOverload]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x4</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Call first method</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
<span class="c"># Call second method</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">(</span><span class="s1">&#39;MyServer&#39;</span><span class="p">,</span><span class="s1">&#39;Example.com&#39;</span><span class="p">)</span>
</code></pre></div><h2 id="powershell-class-inheritance">PowerShell class inheritance</h2>
<p>There are cases when an existing class is almost what you need, but not exactly. You can then create your own class which is based on an already existing class. You can then add methods, properties or other things to fit your need. Here is an example where I use my previous class and add another overloaded method. The trick here is to add a &ldquo;:&rdquo; and then the name of the class you want to inherit from, when creating your new class. In the example below ComputerPSOverload2 inherits from ComputerPSOverload1.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Class inheritance: </span>
<span class="n">class</span> <span class="n">ComputerPSOverload1</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="no">[string]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$ComputerName.$Domain&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c"># Create a second class, based on the one above</span>
<span class="n">class</span> <span class="n">ComputerPSOverload2</span> <span class="err">:</span> <span class="n">ComputerPSOverload1</span>
<span class="p">{</span>
    <span class="c"># Add another overloaded function, with just one parameter</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$prefix</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x5</span> <span class="p">=</span> <span class="no">[ComputerPSOverload2]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x5</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Try two of the methods</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">)</span>
<span class="c"># Check what type the object is, and check the base type</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>
</code></pre></div>
            </div>

            
            <div class="main-content-preview">
                <h1>Classes in Powershell 5.0</h1>
                <p>One of the big new features in Powershell 5.0 is classes. You can now define your own classes and create objects based on those custom classes. You can even create your own version of an existing class using inheritance.</p>
<p>In previous version of Powershell it was actually possible to create classes, but you had to write code in other languages like C# or Visual basic and then use that piece of code as the definition of the class. Now this is much easier.</p>
<p>Lets get right into the code. In these examples I will create a class which contains two properties: ComputerName and Domain. Both will be simple strings. Further down I will add some methods to the class and show some examples on how to use those methods.</p>
<p>First lets look at how we had to create classes before Powershell 5.</p>
<h2 id="create-class-with-c">Create class with C#</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with C sharp</span>
<span class="nv">$ComputerTypeCsharp</span> <span class="p">=</span> <span class="p">@</span><span class="err">”</span>
    <span class="n">public</span> <span class="n">class</span> <span class="n">ComputerCsharp</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">ComputerName</span> <span class="p">{</span><span class="n">get</span><span class="p">;</span> <span class="n">set</span><span class="p">;}</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">Domain</span> <span class="p">{</span><span class="n">get</span><span class="p">;</span> <span class="n">set</span><span class="p">;}</span>
    <span class="p">}</span>
<span class="err">“</span><span class="p">@</span>

<span class="nb">Add-Type</span> <span class="n">-TypeDefinition</span> <span class="nv">$ComputerTypeCsharp</span> <span class="n">-Language</span> <span class="n">CSharpVersion3</span>
 
<span class="nv">$x1</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">ComputerCsharp</span>
<span class="nv">$x1</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span>
<span class="nv">$x1</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x1</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</code></pre></div><h2 id="create-class-with-visual-basic">Create class with Visual Basic</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with Visual Basic</span>
<span class="nv">$ComputerTypeVB</span> <span class="p">=</span> <span class="p">@</span><span class="err">”</span>
    <span class="n">Public</span> <span class="n">Class</span> <span class="n">ComputerVB</span>
        <span class="n">Public</span> <span class="n">ComputerName</span> <span class="n">As</span> <span class="n">String</span>
        <span class="n">Public</span> <span class="n">Domain</span> <span class="n">As</span> <span class="n">String</span>
    <span class="k">End</span> <span class="n">Class</span>
<span class="s2">&#34;@
</span><span class="s2">
</span><span class="s2">Add-Type -TypeDefinition $ComputerTypeVB -Language VisualBasic
</span><span class="s2"> 
</span><span class="s2">$x2 = New-Object -TypeName ComputerVB
</span><span class="s2">$x2.ComputerName = &#39;Server01&#39;
</span><span class="s2">$x2.Domain = &#39;domain.com&#39;
</span><span class="s2">$x2 | Get-Member
</span></code></pre></div><p>Thats fine for simple classes, but when they become more complex its not very easy to read since the whole definition is just one long string with no highlights and syntax which is quite different from Powershell.</p>
<h2 id="powershell-classes">PowerShell classes</h2>
<p>Now lets create the same class, but with Powershell. The syntax for creating a class is straight forward:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">class</span> <span class="n">ComputerPS</span> 
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
<span class="p">}</span>
</code></pre></div><p>To create an object using this class we can use [ComputerPS]::new() and assign that to a variable. Then add the ComputerName and Domain strings. Pipe the variable to Get-Member for further inspection.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Create class with Powershell</span>
<span class="n">class</span> <span class="n">ComputerPS</span> 
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
<span class="p">}</span>
<span class="c"># Create a new variable based on the class</span>
<span class="nv">$x3</span> <span class="p">=</span> <span class="no">[ComputerPS]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="c"># Add a computername</span>
<span class="nv">$x3</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="c"># Add a domain name</span>
<span class="nv">$x3</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="c"># Pipe to Get-Member for inspection</span>
<span class="nv">$x3</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</code></pre></div><h2 id="powershell-classes-with-methods">PowerShell classes with methods</h2>
<p>So now we can add ComputerName and Domain to the object. What if we want to create a method?
Methods are declared like functions within the class. As of the february release of Powershell 5.0, if a method needs to access variables from outside of the method but within the class then you need to add $this before the variable as you can see in the example below. The method added in this example simply merges the strings together to get a fully qualified domain name, but only if ComputerName and Domain contains text.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Powershell class with overloaded methods</span>
<span class="n">class</span> <span class="n">ComputerPSwithMethodOverload</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="c"># Create a method to return fully qualified domain name</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x4</span> <span class="p">=</span> <span class="no">[ComputerPSwithMethodOverload]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x4</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Call the method to get FQDN</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
</code></pre></div><h2 id="powershell-classes-with-overloaded-methods">PowerShell classes with overloaded methods</h2>
<p>You can also create overloaded methods. An overloaded method is a method with the same name as another method but in a different context, in this case with different parameters. In this way the method can be called either without parameters or with two parameters. Powershell will try to match with the most appropriate method depending on how many parameters you use. In this example I add two parameters so that we can create a FQDN for any servers, not just the ones in the current object.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Powershell class with overloaded methods</span>
<span class="n">class</span> <span class="n">ComputerPSwithMethodOverload</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c"># Create another method with the same name, but with different parameters</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="no">[string]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$ComputerName.$Domain&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x4</span> <span class="p">=</span> <span class="no">[ComputerPSwithMethodOverload]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x4</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Call first method</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
<span class="c"># Call second method</span>
<span class="nv">$x4</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">(</span><span class="s1">&#39;MyServer&#39;</span><span class="p">,</span><span class="s1">&#39;Example.com&#39;</span><span class="p">)</span>
</code></pre></div><h2 id="powershell-class-inheritance">PowerShell class inheritance</h2>
<p>There are cases when an existing class is almost what you need, but not exactly. You can then create your own class which is based on an already existing class. You can then add methods, properties or other things to fit your need. Here is an example where I use my previous class and add another overloaded method. The trick here is to add a &ldquo;:&rdquo; and then the name of the class you want to inherit from, when creating your new class. In the example below ComputerPSOverload2 inherits from ComputerPSOverload1.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Class inheritance: </span>
<span class="n">class</span> <span class="n">ComputerPSOverload1</span>
<span class="p">{</span>
    <span class="no">[string]</span> <span class="nv">$ComputerName</span>
    <span class="no">[string]</span> <span class="nv">$Domain</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="no">[string]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$ComputerName.$Domain&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c"># Create a second class, based on the one above</span>
<span class="n">class</span> <span class="n">ComputerPSOverload2</span> <span class="err">:</span> <span class="n">ComputerPSOverload1</span>
<span class="p">{</span>
    <span class="c"># Add another overloaded function, with just one parameter</span>
    <span class="no">[string]</span> <span class="n">GetFQDN</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
            <span class="k">return</span> <span class="s2">&#34;$prefix</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nv">$x5</span> <span class="p">=</span> <span class="no">[ComputerPSOverload2]</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="s1">&#39;server01&#39;</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">Domain</span> <span class="p">=</span> <span class="s1">&#39;domain.com&#39;</span>
<span class="nv">$x5</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="c"># Try two of the methods</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">()</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetFQDN</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">)</span>
<span class="c"># Check what type the object is, and check the base type</span>
<span class="nv">$x5</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>
</code></pre></div>
            </div>

       </div>
    


            </div>
        </div>
    </body>
</html>
