<!DOCTYPE html>
<html lang="en">




    



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <meta name='twitter:card'        content='summary' />
    <meta name='twitter:site'        content='@johnmroos'/>
    <meta name='twitter:creator'     content='@johnmroos'/>
    <meta name='twitter:title'       content='Use Edit-Command to discover the code behind built-in cmdlets' />
    <meta name='twitter:description' content='Did you know that there are a lot of built-in cmdlets which are written entirely in PowerShell? Did you also know that you can view the source of those cmdlets? Well, you can. Get-Command shows all the details we need. When you run Get-Command you get all kinds of details about the commands you are looking for. One of the properties in the output is called ScriptBlock. That&rsquo;s where the code is, if its written in PowerShell.' />
    
    <meta name='twitter:domain'      content='https://blog.roostech.se/'/>
    

    <title>Use Edit-Command to discover the code behind built-in cmdlets</title>
    <meta name="description" content="Did you know that there are a lot of built-in cmdlets which are written entirely in PowerShell? Did you also know that you can view the source of those cmdlets? Well, you can. Get-Command shows all the details we need. When you run Get-Command you get all kinds of details about the commands you are looking for. One of the properties in the output is called ScriptBlock. That&rsquo;s where the code is, if its written in PowerShell."/>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-35019756-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle">
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><span class="rotate-letter">></span><span class="menu-item"><a class="menu-item-site" href="https://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></span>
            <ul>  
                <li><span class="rotate-letter">></span><span class="menu-item">content</span>
                    <ul>
                        <li><span class="rotate-letter">></span><span class="menu-item">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li class="current"><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li ><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li ><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="rotate-letter">></span><span class="menu-item">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                                <li ><a href="/gists/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Gists.md</span></a></li>
                                
                                <li ><a href="/parameter-validation/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Parameter Validation.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>><span class="menu-item">data</span></li>
                <li>><span class="menu-item">layouts</span></li>
                <li>><span class="menu-item">resources</span></li>
                <li>><span class="menu-item">static</span></li>
                <li>><span class="menu-item">themes</span></li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV><div class='main'>
     
     
     
    
     
    
     
    
     
    
     
    
    
    
    
        
        <div class="main-tabs">
            <div class="main-tabs-scroll">
                <div class="main-tabs-table">
                    <div class ="main-tabs-row">
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                        </div>
                    
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/pester-5-discovery-and-testcases/">Pester 5: Discovery and TestCases.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/create-and-use-azure-table-storage-with-powershell/">Create and use Azure Table storage with PowerShell.md</a>
                        </div>
                    
                        <div class="main-tab current">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/">Use Edit-Command to discover the code behind built-in cmdlets.md</a>
                        </div>
                    
                    </div>
                </div>
            </div>
        </div>
        <div class="main-path">
            <a class="path-link" href="https://blog.roostech.se/">blog.roostech.se</a> > content > posts &gt; Use Edit-Command to discover the code behind built-in cmdlets.md
        </div>
        <div class="main-content-toggle">

            
            <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
            <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

            <input class="source-toggle" type="checkbox" id="source-toggle">
            <label class="source-toggle-label" for="source-toggle"></label>

            <div class="main-content">
                ---<br />
                <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">Use Edit-Command to discover the code behind built-in cmdlets</span><br />
                <span class="md-frontmatter">date</span>: 2017-02-22 14:14:00 &#43;0200 &#43;0200<br />
                <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
                <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John</span><br />
                ----
                <p>Did you know that there are a lot of built-in cmdlets which are written entirely in PowerShell? Did you also know that you can view the source of those cmdlets? Well, you can. Get-Command shows all the details we need. When you run Get-Command you get all kinds of details about the commands you are looking for. One of the properties in the output is called ScriptBlock. That&rsquo;s where the code is, if its written in PowerShell.</p>
<p>Lets take a quick example. First check how many commands are available, and then how many of those have a script block attached to them.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="p">(</span><span class="nb">Get-Command</span><span class="p">).</span><span class="n">count</span>
<span class="n">1861</span>

<span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="p">(</span><span class="nb">Get-Command</span> <span class="p">|</span> <span class="p">?</span> <span class="n">scriptblock</span><span class="p">).</span><span class="n">count</span>
<span class="n">955</span>
</code></pre></div><p>In this system I have a total of 1861 commands, and 955 of those are written in PowerShell. That&rsquo;s cool. Get-Verb is one of those commands. Lets have a look at that and expand the script block property.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-Command</span> <span class="n">-Name</span> <span class="nb">Get-Verb</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="n">scriptblock</span>

<span class="k">param</span><span class="p">(</span>
    <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">ValueFromPipeline</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
    <span class="no">[string[]]</span>
    <span class="nv">$verb</span> <span class="p">=</span> <span class="s1">&#39;*&#39;</span>
<span class="p">)</span>
<span class="k">begin</span> <span class="p">{</span>
    <span class="nv">$allVerbs</span> <span class="p">=</span> 
<span class="no">[System.Reflection.IntrospectionExtensions]</span><span class="p">::</span><span class="n">GetTypeInfo</span><span class="p">(</span><span class="no">[PSObject]</span><span class="p">).</span><span class="n">Assembly</span><span class="p">.</span><span class="n">ExportedTypes</span> 
<span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Core</span><span class="p">\</span><span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;^Verbs.&#39;</span><span class="p">}</span> <span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Utility</span><span class="p">\</span><span class="nb">Get-Member</span> <span class="n">-type</span> <span class="n">Properties</span> <span class="n">-static</span> <span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Utility</span><span class="p">\</span><span class="nb">Select-Object</span> <span class="p">@{</span>
            <span class="n">Name</span><span class="p">=</span><span class="s1">&#39;Verb&#39;</span>
            <span class="n">Expression</span> <span class="p">=</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span>
        <span class="p">},</span> <span class="p">@{</span>
            <span class="n">Name</span><span class="p">=</span><span class="s1">&#39;Group&#39;</span>
            <span class="n">Expression</span> <span class="p">=</span> <span class="p">{</span>
                <span class="nv">$str</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">TypeName</span><span class="p">)</span><span class="s2">&#34;</span>
                <span class="nv">$str</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="nv">$str</span><span class="p">.</span><span class="n">LastIndexOf</span><span class="p">(</span><span class="s1">&#39;Verbs&#39;</span><span class="p">)</span> <span class="p">+</span> <span class="n">5</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
<span class="k">process</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$v</span> <span class="k">in</span> <span class="nv">$verb</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$allVerbs</span> <span class="p">|</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Core</span><span class="p">\</span><span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Verb</span> <span class="o">-like</span> <span class="nv">$v</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c"># </span><span class="sd">.Link</span>
<span class="c"># http://go.microsoft.com/fwlink/?LinkID=160712</span>
<span class="c"># </span><span class="sd">.ExternalHelp</span><span class="c"> System.Management.Automation.dll-help.xml</span>
</code></pre></div><p>But why not add the result to a new tab in the PowerShell ISE? I wrote a simple cmdlet for that, called Edit-Command. When you run Edit-Command it will check if the command have a script block and in that case open a new tab in ISE with the content from the script block. In the top of the new tab it will add some meta data about the command, like name, type, version and source.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Edit-Command</span> <span class="n">-Name</span> <span class="nb">Get-Verb</span>
</code></pre></div><p>Pretty neat. Below is the code for Edit-Command if you want to try it yourself.</p>
<h2 id="edit-command">Edit-Command</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="k">function</span> <span class="nb">Edit-Command</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="p">[</span><span class="n">OutputType</span><span class="p">(</span><span class="no">[void]</span><span class="p">)]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">validatenotnullorempty</span><span class="p">()]</span>
        <span class="no">[string]</span><span class="nv">$Name</span>
    <span class="p">)</span>
 
    <span class="k">Process</span>
    <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nv">$command</span> <span class="p">=</span> <span class="nb">Get-Command</span> <span class="n">-Name</span> <span class="nv">$Name</span> <span class="n">-ErrorAction</span> <span class="n">Stop</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="k">Throw</span> <span class="nv">$Error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span>
        <span class="p">}</span>
 
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$command</span> <span class="o">-is</span> <span class="no">[array]</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="s1">&#39;Multiple commands found. You need to be more specific.&#39;</span>
        <span class="p">}</span>
 
        <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nv">$scriptblock</span> <span class="p">=</span> <span class="nv">$command</span><span class="p">.</span><span class="n">ScriptBlock</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$exception</span> <span class="p">=</span> <span class="s2">&#34;The command does not have a scriptblock available.&#34;</span>
            <span class="k">Throw</span> <span class="nv">$exception</span>
        <span class="p">}</span>
 
        <span class="nv">$code</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">StringBuilder</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Command: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Type: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">CommandType</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Version: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Version</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Source: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Source</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="nv">$scriptblock</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
 
        <span class="n">OpenTab</span> <span class="n">-code</span> <span class="nv">$code</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="n">OpenTab</span> <span class="p">{</span>
    <span class="k">param</span> <span class="p">(</span> <span class="no">[System.Text.StringBuilder]</span><span class="nv">$code</span> <span class="p">)</span>
 
    <span class="nv">$displayname</span> <span class="p">=</span> <span class="nv">$psISE</span><span class="p">.</span><span class="n">CurrentPowerShellTab</span><span class="p">.</span><span class="n">Files</span><span class="p">.</span><span class="n">Add</span><span class="p">().</span><span class="n">DisplayName</span>
    <span class="nv">$openfile</span> <span class="p">=</span> <span class="nv">$psISE</span><span class="p">.</span><span class="n">PowerShellTabs</span><span class="p">.</span><span class="n">files</span> <span class="p">|</span> 
        <span class="nb">Where-Object</span> <span class="n">DisplayName</span> <span class="o">-eq</span> <span class="nv">$displayname</span> <span class="p">|</span> 
        <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">1</span>

    <span class="nv">$openfile</span><span class="p">.</span><span class="n">Editor</span><span class="p">.</span><span class="n">Text</span> <span class="p">+=</span> <span class="nv">$code</span>
    <span class="nv">$openfile</span><span class="p">.</span><span class="n">Editor</span><span class="p">.</span><span class="n">SetCaretPosition</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>This code is also available on <a href="https://github.com/JohnRoos/PowerShell/tree/master/Modules/Edit-Command">GitHub</a>.</p>

            </div>

            
            <div class="main-content-preview">
                <h1>Use Edit-Command to discover the code behind built-in cmdlets</h1>
                <p>Did you know that there are a lot of built-in cmdlets which are written entirely in PowerShell? Did you also know that you can view the source of those cmdlets? Well, you can. Get-Command shows all the details we need. When you run Get-Command you get all kinds of details about the commands you are looking for. One of the properties in the output is called ScriptBlock. That&rsquo;s where the code is, if its written in PowerShell.</p>
<p>Lets take a quick example. First check how many commands are available, and then how many of those have a script block attached to them.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="p">(</span><span class="nb">Get-Command</span><span class="p">).</span><span class="n">count</span>
<span class="n">1861</span>

<span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="p">(</span><span class="nb">Get-Command</span> <span class="p">|</span> <span class="p">?</span> <span class="n">scriptblock</span><span class="p">).</span><span class="n">count</span>
<span class="n">955</span>
</code></pre></div><p>In this system I have a total of 1861 commands, and 955 of those are written in PowerShell. That&rsquo;s cool. Get-Verb is one of those commands. Lets have a look at that and expand the script block property.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Get-Command</span> <span class="n">-Name</span> <span class="nb">Get-Verb</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="n">scriptblock</span>

<span class="k">param</span><span class="p">(</span>
    <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">ValueFromPipeline</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
    <span class="no">[string[]]</span>
    <span class="nv">$verb</span> <span class="p">=</span> <span class="s1">&#39;*&#39;</span>
<span class="p">)</span>
<span class="k">begin</span> <span class="p">{</span>
    <span class="nv">$allVerbs</span> <span class="p">=</span> 
<span class="no">[System.Reflection.IntrospectionExtensions]</span><span class="p">::</span><span class="n">GetTypeInfo</span><span class="p">(</span><span class="no">[PSObject]</span><span class="p">).</span><span class="n">Assembly</span><span class="p">.</span><span class="n">ExportedTypes</span> 
<span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Core</span><span class="p">\</span><span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;^Verbs.&#39;</span><span class="p">}</span> <span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Utility</span><span class="p">\</span><span class="nb">Get-Member</span> <span class="n">-type</span> <span class="n">Properties</span> <span class="n">-static</span> <span class="p">|</span>
        <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Utility</span><span class="p">\</span><span class="nb">Select-Object</span> <span class="p">@{</span>
            <span class="n">Name</span><span class="p">=</span><span class="s1">&#39;Verb&#39;</span>
            <span class="n">Expression</span> <span class="p">=</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span>
        <span class="p">},</span> <span class="p">@{</span>
            <span class="n">Name</span><span class="p">=</span><span class="s1">&#39;Group&#39;</span>
            <span class="n">Expression</span> <span class="p">=</span> <span class="p">{</span>
                <span class="nv">$str</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">TypeName</span><span class="p">)</span><span class="s2">&#34;</span>
                <span class="nv">$str</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="nv">$str</span><span class="p">.</span><span class="n">LastIndexOf</span><span class="p">(</span><span class="s1">&#39;Verbs&#39;</span><span class="p">)</span> <span class="p">+</span> <span class="n">5</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
<span class="k">process</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$v</span> <span class="k">in</span> <span class="nv">$verb</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$allVerbs</span> <span class="p">|</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">PowerShell</span><span class="p">.</span><span class="n">Core</span><span class="p">\</span><span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Verb</span> <span class="o">-like</span> <span class="nv">$v</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c"># </span><span class="sd">.Link</span>
<span class="c"># http://go.microsoft.com/fwlink/?LinkID=160712</span>
<span class="c"># </span><span class="sd">.ExternalHelp</span><span class="c"> System.Management.Automation.dll-help.xml</span>
</code></pre></div><p>But why not add the result to a new tab in the PowerShell ISE? I wrote a simple cmdlet for that, called Edit-Command. When you run Edit-Command it will check if the command have a script block and in that case open a new tab in ISE with the content from the script block. In the top of the new tab it will add some meta data about the command, like name, type, version and source.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">PS </span><span class="n">C:</span><span class="p">\&gt;</span> <span class="nb">Edit-Command</span> <span class="n">-Name</span> <span class="nb">Get-Verb</span>
</code></pre></div><p>Pretty neat. Below is the code for Edit-Command if you want to try it yourself.</p>
<h2 id="edit-command">Edit-Command</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="k">function</span> <span class="nb">Edit-Command</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="p">[</span><span class="n">OutputType</span><span class="p">(</span><span class="no">[void]</span><span class="p">)]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">validatenotnullorempty</span><span class="p">()]</span>
        <span class="no">[string]</span><span class="nv">$Name</span>
    <span class="p">)</span>
 
    <span class="k">Process</span>
    <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nv">$command</span> <span class="p">=</span> <span class="nb">Get-Command</span> <span class="n">-Name</span> <span class="nv">$Name</span> <span class="n">-ErrorAction</span> <span class="n">Stop</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="k">Throw</span> <span class="nv">$Error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span>
        <span class="p">}</span>
 
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$command</span> <span class="o">-is</span> <span class="no">[array]</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="s1">&#39;Multiple commands found. You need to be more specific.&#39;</span>
        <span class="p">}</span>
 
        <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nv">$scriptblock</span> <span class="p">=</span> <span class="nv">$command</span><span class="p">.</span><span class="n">ScriptBlock</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$exception</span> <span class="p">=</span> <span class="s2">&#34;The command does not have a scriptblock available.&#34;</span>
            <span class="k">Throw</span> <span class="nv">$exception</span>
        <span class="p">}</span>
 
        <span class="nv">$code</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">StringBuilder</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Command: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Type: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">CommandType</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Version: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Version</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="s2">&#34;# Source: </span><span class="p">$(</span><span class="nv">$command</span><span class="p">.</span><span class="n">Source</span><span class="p">)</span><span class="se">`n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
        <span class="nv">$code</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="nv">$scriptblock</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Out-Null</span>
 
        <span class="n">OpenTab</span> <span class="n">-code</span> <span class="nv">$code</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="n">OpenTab</span> <span class="p">{</span>
    <span class="k">param</span> <span class="p">(</span> <span class="no">[System.Text.StringBuilder]</span><span class="nv">$code</span> <span class="p">)</span>
 
    <span class="nv">$displayname</span> <span class="p">=</span> <span class="nv">$psISE</span><span class="p">.</span><span class="n">CurrentPowerShellTab</span><span class="p">.</span><span class="n">Files</span><span class="p">.</span><span class="n">Add</span><span class="p">().</span><span class="n">DisplayName</span>
    <span class="nv">$openfile</span> <span class="p">=</span> <span class="nv">$psISE</span><span class="p">.</span><span class="n">PowerShellTabs</span><span class="p">.</span><span class="n">files</span> <span class="p">|</span> 
        <span class="nb">Where-Object</span> <span class="n">DisplayName</span> <span class="o">-eq</span> <span class="nv">$displayname</span> <span class="p">|</span> 
        <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">1</span>

    <span class="nv">$openfile</span><span class="p">.</span><span class="n">Editor</span><span class="p">.</span><span class="n">Text</span> <span class="p">+=</span> <span class="nv">$code</span>
    <span class="nv">$openfile</span><span class="p">.</span><span class="n">Editor</span><span class="p">.</span><span class="n">SetCaretPosition</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><p>This code is also available on <a href="https://github.com/JohnRoos/PowerShell/tree/master/Modules/Edit-Command">GitHub</a>.</p>


                
                    <div class="disqus-section">
                        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "blog-roostech-se" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    </div>
                
            </div>

       </div>
    


            </div>
        </div>
    </body>
</html>
