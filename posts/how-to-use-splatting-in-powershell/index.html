<!DOCTYPE html>
<html lang="en">




    



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <meta name='twitter:card'        content='summary' />
    <meta name='twitter:site'        content='@johnmroos'/>
    <meta name='twitter:creator'     content='@johnmroos'/>
    <meta name='twitter:title'       content='How to use splatting in PowerShell' />
    <meta name='twitter:description' content='I still hear a lot of people who don&rsquo;t know how splatting works in Powershell. Splatting was introduced in Powershell 2.0 so it has been around for a while and it can make scripts look more clean and easy to read. This is how Microsoft explains splatting:
 Splatting is a method of passing a collection of parameter values to a command as unit. Windows PowerShell associates each value in the collection with a command parameter.' />
    
    <meta name='twitter:domain'      content='https://blog.roostech.se/'/>
    

    <title>How to use splatting in PowerShell</title>
    <meta name="description" content="I still hear a lot of people who don&rsquo;t know how splatting works in Powershell. Splatting was introduced in Powershell 2.0 so it has been around for a while and it can make scripts look more clean and easy to read. This is how Microsoft explains splatting:
 Splatting is a method of passing a collection of parameter values to a command as unit. Windows PowerShell associates each value in the collection with a command parameter."/>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-35019756-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle">
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><div class="menu-item folder open"><a class="menu-item-site" href="https://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></div>
            <ul>  
                <li><span class="menu-item folder open">content</span>
                    <ul>
                        <li><span class="menu-item folder open">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li class="current"><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li ><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li ><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="menu-item folder open">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                                <li ><a href="/gists/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Gists.md</span></a></li>
                                
                                <li ><a href="/parameter-validation/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Parameter Validation.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><span class="menu-item folder">data</span></li>
                <li><span class="menu-item folder">layouts</span></li>
                <li><span class="menu-item folder">resources</span></li>
                <li><span class="menu-item folder">static</span></li>
                <li><span class="menu-item folder">themes</span></li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV><div class='main'>
     
     
     
    
     
    
     
    
     
    
     
    
    
        
        <div class="main-tabs">
            <div class="main-tabs-scroll">
                <div class="main-tabs-table">
                    <div class ="main-tabs-row">
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                        </div>
                    
                        <div class="main-tab current">
                            <span class="rotate-letter md-icon">&#10144;</span> <i>How to use splatting in PowerShell.md</i> 
                        </div>
                    
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/pester-5-discovery-and-testcases/">Pester 5: Discovery and TestCases.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/create-and-use-azure-table-storage-with-powershell/">Create and use Azure Table storage with PowerShell.md</a>
                        </div>
                    
                        <div class="main-tab">
                            <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/">Use Edit-Command to discover the code behind built-in cmdlets.md</a>
                        </div>
                    
                    </div>
                </div>
            </div>
        </div>
        <div class="main-path">
            <span><a class="path-link" href="https://blog.roostech.se/">blog.roostech.se</a></span><span class="folder">content</span><span class="folder">posts</span><span class="folder">How to use splatting in PowerShell.md</span>
        </div>
        <div class="main-content-toggle">

            
            <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
            <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

            <input class="source-toggle" type="checkbox" id="source-toggle">
            <label class="source-toggle-label" for="source-toggle"></label>

            <div class="main-content">
                ---<br />
                <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">How to use splatting in PowerShell</span><br />
                <span class="md-frontmatter">date</span>: 2015-07-09 14:14:00 &#43;0200 CEST<br />
                <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
                <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John</span><br />
                ----
                <p>I still hear a lot of people who don&rsquo;t know how splatting works in Powershell. Splatting was introduced in Powershell 2.0 so it has been around for a while and it can make scripts look more clean and easy to read. This is how Microsoft explains splatting:</p>
<blockquote>
<p>Splatting is a method of passing a collection of parameter values to a command as unit. Windows PowerShell associates each value in the collection with a command parameter.</p>
</blockquote>
<p>I will give some examples on how to use splatting and show why it can be useful. Splatting can be used either with arrays or hashtables. Arrays are used for commands that have positional parameters and hash tables are used when named parameters are needed.</p>
<h2 id="array-splatting">Array splatting</h2>
<p>Lets start with an example and splat parameters into an array. First you need a command that accepts positional parameters (parameters you can use without naming them). I will use Invoke-Command in this example, which has two positional parameters (ComputerName and ScriptBlock) and can be used in the following way:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Invoke-Command</span> <span class="n">Server01</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
</code></pre></div><p>If we want to use splatting on this we would add these two parameter values to an array first and then add the array to the command instead of the parameters.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span><span class="p">,</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
<span class="nb">Invoke-Command</span> <span class="nv">@params</span>
</code></pre></div><p>If you look closely you can see that the variable $params starts with a dollar symbol, but when its used in splatting the &ldquo;@&rdquo; symbol is used. The &ldquo;@&rdquo; symbol tells PowerShell that this variable is a collection of parameters and should be treated as parameters. If a dollar symbol was used PowerShell would just consider it to be an array of values to the first positional parameter and that&rsquo;s not what we want in this case.</p>
<p>You can also mix this technique with regular parameters if needed:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span><span class="p">,</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
<span class="nb">Invoke-Command</span> <span class="nv">@params</span> <span class="n">-ErrorVariable</span> <span class="n">Err</span>
</code></pre></div><h2 id="hash-table-splatting">Hash table splatting</h2>
<p>Not all parameters are positional and using positional parameters can make the code harder to read. I prefer to use named parameters as often as possible, even if it means more letters to punch in. If we want to use splatting with named parameters we need to use a hash table instead of an array.</p>
<p>I will go straight to examples which probably explains this better than words. I will use my own cmdlet, Write-ObjectToSQL, which I wrote about some time back. This cmdlet has quite a few parameters which makes it a good candidate, since the command line can get quite long as you can see in the example below.</p>
<p>The command below will get all the processes running on the machine and write all the information to a database table. Exactly what it does is not important for this topic. You can read more details about this cmdlet here.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="n">-Server</span> <span class="n">localhost</span><span class="p">\</span><span class="n">sqlexpress</span> <span class="n">-Database</span> <span class="n">MyDB</span> <span class="n">-TableName</span> <span class="n">MyTable</span> <span class="n">-ReportEveryXObject</span> <span class="n">100</span>
</code></pre></div><p>Now lets use splatting with a hash table where every key/value pair represents a named parameter.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span>
</code></pre></div><p>Again, the &ldquo;@&rdquo; symbol on the last line is the magic here, just like when using an array. This works with all kinds of parameters, including switch parameters and common parameters:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
    <span class="s1">&#39;DoNotCreateTable&#39;</span>   <span class="p">=</span> <span class="nv">$true</span>
    <span class="s1">&#39;ErrorVariable&#39;</span>      <span class="p">=</span> <span class="s1">&#39;err&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span>
</code></pre></div><p>You can mix with regular parameters as well.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
    <span class="s1">&#39;DoNotCreateTable&#39;</span>   <span class="p">=</span> <span class="nv">$true</span>
    <span class="s1">&#39;ErrorVariable&#39;</span>      <span class="p">=</span> <span class="s1">&#39;err&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span> <span class="n">-Verbose</span>
</code></pre></div><p>However, you cannot add the same parameter more than once.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span> <span class="n">-TableName</span> <span class="n">MyOtherTable</span>
<span class="c">#Error: Cannot bind parameter because parameter TableName is specified more than once</span>
</code></pre></div><p>To read more about this topic write &ldquo;Get-Help about_splatting&rdquo; in the PowerShell console or read the web version <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_splatting">here</a>.</p>

            </div>

            
            <div class="main-content-preview">
                <h1>How to use splatting in PowerShell</h1>
                <p>I still hear a lot of people who don&rsquo;t know how splatting works in Powershell. Splatting was introduced in Powershell 2.0 so it has been around for a while and it can make scripts look more clean and easy to read. This is how Microsoft explains splatting:</p>
<blockquote>
<p>Splatting is a method of passing a collection of parameter values to a command as unit. Windows PowerShell associates each value in the collection with a command parameter.</p>
</blockquote>
<p>I will give some examples on how to use splatting and show why it can be useful. Splatting can be used either with arrays or hashtables. Arrays are used for commands that have positional parameters and hash tables are used when named parameters are needed.</p>
<h2 id="array-splatting">Array splatting</h2>
<p>Lets start with an example and splat parameters into an array. First you need a command that accepts positional parameters (parameters you can use without naming them). I will use Invoke-Command in this example, which has two positional parameters (ComputerName and ScriptBlock) and can be used in the following way:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Invoke-Command</span> <span class="n">Server01</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
</code></pre></div><p>If we want to use splatting on this we would add these two parameter values to an array first and then add the array to the command instead of the parameters.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span><span class="p">,</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
<span class="nb">Invoke-Command</span> <span class="nv">@params</span>
</code></pre></div><p>If you look closely you can see that the variable $params starts with a dollar symbol, but when its used in splatting the &ldquo;@&rdquo; symbol is used. The &ldquo;@&rdquo; symbol tells PowerShell that this variable is a collection of parameters and should be treated as parameters. If a dollar symbol was used PowerShell would just consider it to be an array of values to the first positional parameter and that&rsquo;s not what we want in this case.</p>
<p>You can also mix this technique with regular parameters if needed:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="s1">&#39;Server01&#39;</span><span class="p">,</span> <span class="s1">&#39;C:\script.ps1&#39;</span>
<span class="nb">Invoke-Command</span> <span class="nv">@params</span> <span class="n">-ErrorVariable</span> <span class="n">Err</span>
</code></pre></div><h2 id="hash-table-splatting">Hash table splatting</h2>
<p>Not all parameters are positional and using positional parameters can make the code harder to read. I prefer to use named parameters as often as possible, even if it means more letters to punch in. If we want to use splatting with named parameters we need to use a hash table instead of an array.</p>
<p>I will go straight to examples which probably explains this better than words. I will use my own cmdlet, Write-ObjectToSQL, which I wrote about some time back. This cmdlet has quite a few parameters which makes it a good candidate, since the command line can get quite long as you can see in the example below.</p>
<p>The command below will get all the processes running on the machine and write all the information to a database table. Exactly what it does is not important for this topic. You can read more details about this cmdlet here.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="n">-Server</span> <span class="n">localhost</span><span class="p">\</span><span class="n">sqlexpress</span> <span class="n">-Database</span> <span class="n">MyDB</span> <span class="n">-TableName</span> <span class="n">MyTable</span> <span class="n">-ReportEveryXObject</span> <span class="n">100</span>
</code></pre></div><p>Now lets use splatting with a hash table where every key/value pair represents a named parameter.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span>
</code></pre></div><p>Again, the &ldquo;@&rdquo; symbol on the last line is the magic here, just like when using an array. This works with all kinds of parameters, including switch parameters and common parameters:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
    <span class="s1">&#39;DoNotCreateTable&#39;</span>   <span class="p">=</span> <span class="nv">$true</span>
    <span class="s1">&#39;ErrorVariable&#39;</span>      <span class="p">=</span> <span class="s1">&#39;err&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span>
</code></pre></div><p>You can mix with regular parameters as well.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
    <span class="s1">&#39;ReportEveryXObject&#39;</span> <span class="p">=</span> <span class="n">100</span>
    <span class="s1">&#39;DoNotCreateTable&#39;</span>   <span class="p">=</span> <span class="nv">$true</span>
    <span class="s1">&#39;ErrorVariable&#39;</span>      <span class="p">=</span> <span class="s1">&#39;err&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span> <span class="n">-Verbose</span>
</code></pre></div><p>However, you cannot add the same parameter more than once.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;Server&#39;</span>             <span class="p">=</span> <span class="s1">&#39;localhost\sqlexpress&#39;</span>
    <span class="s1">&#39;Database&#39;</span>           <span class="p">=</span> <span class="s1">&#39;MyDB&#39;</span>
    <span class="s1">&#39;TableName&#39;</span>          <span class="p">=</span> <span class="s1">&#39;MyTable&#39;</span>
<span class="p">}</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Write-ObjectToSQL</span> <span class="nv">@params</span> <span class="n">-TableName</span> <span class="n">MyOtherTable</span>
<span class="c">#Error: Cannot bind parameter because parameter TableName is specified more than once</span>
</code></pre></div><p>To read more about this topic write &ldquo;Get-Help about_splatting&rdquo; in the PowerShell console or read the web version <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_splatting">here</a>.</p>


                
                    <div class="disqus-section">
                        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "blog-roostech-se" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    </div>
                
            </div>

       </div>
    


            </div>
        </div>
    </body>
</html>
