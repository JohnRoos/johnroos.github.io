 
 

 

 

 

 

 


<!DOCTYPE html>
<html lang="en">




    



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <meta name='twitter:card'        content='summary' />
    <meta name='twitter:site'        content='@johnmroos'/>
    <meta name='twitter:creator'     content='@johnmroos'/>
    <meta name='twitter:title'       content='Get-Type alternative for $null values' />
    <meta name='twitter:description' content='Sometimes its useful to get information about object properties in PowerShell. You might be writing a script where you want to extract information from a series of objects and you need to know what data type a property contains. Often this is not a big problem since you can use the GetType function that most objects have.
Then you run in to the problem that I had recently: You expect a series of objects and you check the types on the properties and suddenly a few of them doesn&rsquo;t have the function GetType for some reason.' />
    
    <meta name='twitter:domain'      content='https://blog.roostech.se/'/>
    

    <title>Get-Type alternative for $null values</title>
    <meta name="description" content="Sometimes its useful to get information about object properties in PowerShell. You might be writing a script where you want to extract information from a series of objects and you need to know what data type a property contains. Often this is not a big problem since you can use the GetType function that most objects have.
Then you run in to the problem that I had recently: You expect a series of objects and you check the types on the properties and suddenly a few of them doesn&rsquo;t have the function GetType for some reason."/>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F2VG64X4H"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9F2VG64X4H', { 'anonymize_ip': false });
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle">
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><div class="menu-item folder open"><a class="menu-item-site" href="https://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></div>
            <ul>  
                <li><span class="menu-item folder open">content</span>
                    <ul>
                        <li><span class="menu-item folder open">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/set-up-built-in-authentication-for-azure-static-web-app/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Set up built-in authentication for Azure Static Web App.md</span></a></li>
                                
                                <li ><a href="/posts/deploy-azure-static-web-app-using-bicep-and-yaml-pipeline/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Static Web App using Bicep and YAML pipeline.md</span></a></li>
                                
                                <li ><a href="/posts/get-function-configuration-from-deployed-function-app/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get function configuration from deployed Function App.md</span></a></li>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li ><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li class="current"><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="menu-item folder open">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                                <li ><a href="/chroma/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Chroma.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><span class="menu-item folder">data</span></li>
                <li><span class="menu-item folder">layouts</span></li>
                <li><span class="menu-item folder">resources</span></li>
                <li><span class="menu-item folder">static</span></li>
                <li><span class="menu-item folder open">themes</span>
                    <ul>
                        <li><span class="menu-item folder open">hugovscode</span>
                            <ul>
                                <li><a href="https://github.com/JohnRoos/HugoVSCode/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">.git</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV>
                <div class ="main-tabs">
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                    </div>
                
                    <div class="main-tab current">
                        <span class="rotate-letter md-icon">&#10144;</span> <i>Get-Type alternative for null values.md</i> 
                    </div>
                
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/set-up-built-in-authentication-for-azure-static-web-app/">Set up built-in authentication for Azure Static Web App.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-static-web-app-using-bicep-and-yaml-pipeline/">Deploy Azure Static Web App using Bicep and YAML pipeline.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/get-function-configuration-from-deployed-function-app/">Get function configuration from deployed Function App.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                    </div>
                
                </div>
            
            
            <div class='main'>
    <div class="main-path">
        <span><a class="path-link" href="https://blog.roostech.se/">blog.roostech.se</a></span><span class="folder">content</span><span class="folder">posts</span><span class="folder">Get-Type alternative for $null values.md</span>
        
                
                
                <span class="postdate-container">&nbsp;(<time class="postdate" datetime="2014-12-20">December 20, 2014</time>)</span>
            
    </div>
    
    <div class="main-content-toggle">

        
        <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
        <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

        <input class="source-toggle" type="checkbox" id="source-toggle">
        <label class="source-toggle-label" for="source-toggle"></label>

        <div class="main-content">
            ---<br />
            <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">Get-Type alternative for $null values</span><br />
            <span class="md-frontmatter">date</span>: 2014-12-20 14:14:00 &#43;0200 &#43;0200<br />
            <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
            <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John Roos</span><br />
            ----
            <p>Sometimes its useful to get information about object properties in PowerShell. You might be writing a script where you want to extract information from a series of objects and you need to know what data type a property contains. Often this is not a big problem since you can use the GetType function that most objects have.</p>
<p>Then you run in to the problem that I had recently: You expect a series of objects and you check the types on the properties and suddenly a few of them doesn&rsquo;t have the function GetType for some reason. What I realized was that if a property is Null then a lot of features for that property doesn&rsquo;t work anymore. I did figure out a workaround for this, even if its not very pretty. I thought I share this in case more people stumble on the same issue.</p>
<p>So what is the problem? Well, it seems like PowerShell considers a property with a null value to not exist, kind of. Let me do an example with Get-Process.</p>
<p>Lets start with how it usually works, when there is no problem: Get-Process for Internet Explorer. Get-Process returns one object per process as usual. Lets pick a property that we want to examine. I pick StartTime which I expect is when the process started, but I haven&rsquo;t checked. It doesn&rsquo;t matter what it means for this example.
Then we check the data type for that property. Something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Sample any object property. </span>
</span></span><span class="line"><span class="cl"><span class="c"># In this case StartTime from IE coming from from Get-Process.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">iexplore</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span></code></pre></div><p>This will return &ldquo;DateTime&rdquo;. So far so good. What if we look for a process that doesn&rsquo;t have a value for StartTime? How about the mysterious Idle process?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Doesnt work if the property is empty</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">Idle</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span></code></pre></div><p>This returns an error: &ldquo;You cannot call a method on a null-valued expression.&rdquo;
That&rsquo;s a bit weird since its the same kind of object. They are both of the type System.Diagnostics.Process, but they seem to be different. Well, they are the same type, but PowerShell behaves this way when the value is null. You can get the feeling that it doesn&rsquo;t exist, and cannot have any functions.</p>
<p>There is other ways to get this information. One way is to use the output from Get-Member in a not-so-standard way. Parsing through the result to get what you need. This is a last resort, but works in most cases.</p>
<p>This is what you get if you pipe the object to Get-Member:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">PS C:\&gt;$sampleObject | Get-Member -MemberType Properties | Where-Object {$_.Name -eq &#34;StartTime&#34;}
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">   TypeName: System.Diagnostics.Process
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">Name      MemberType Definition
</span></span><span class="line"><span class="cl">----      ---------- ----------
</span></span><span class="line"><span class="cl">StartTime Property   datetime StartTime {get;}
</span></span></code></pre></div><p>Under Definition you can see &ldquo;datetime&rdquo;. That&rsquo;s what we need. So lets parse through Definition and remove everything after the first space.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># This time we are using the output from Get-Member, selecting StartTime </span>
</span></span><span class="line"><span class="cl"><span class="c"># and removing anything after the space (&#39; &#39;).</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">Idle</span>
</span></span><span class="line"><span class="cl"><span class="nv">$propertyName</span> <span class="p">=</span> <span class="nv">$sampleObject</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="n">-MemberType</span> <span class="n">Properties</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                              <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="s1">&#39;StartTime&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">Remove</span><span class="p">(</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">IndexOf</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">)</span>
</span></span></code></pre></div><p>This will output &ldquo;datetime&rdquo;. As long as you are not case sensitive, this could work as a workaround.
I would prefer the first option to use the GetType so why not use that one first and then fall back on the second option if it doesn&rsquo;t work. Lets try both iexplore and Idle while we&rsquo;re at it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$processes</span> <span class="p">=</span> <span class="s1">&#39;Idle&#39;</span><span class="p">,</span><span class="s1">&#39;iexplore&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$process</span> <span class="k">in</span> <span class="nv">$processes</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="nv">$process</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$typeName</span> <span class="p">=</span> <span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$propertyName</span> <span class="p">=</span> <span class="nv">$sampleObject</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="n">-MemberType</span> <span class="n">Properties</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                                          <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="s1">&#39;StartTime&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$typeName</span> <span class="p">=</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">Remove</span><span class="p">(</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">IndexOf</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">catch</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$typeName</span> <span class="p">=</span> <span class="s1">&#39;Doh!&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">$process</span><span class="s2"> = </span><span class="nv">$typeName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This should now output &ldquo;datetime&rdquo; for Idle and &ldquo;DateTime&rdquo; for iexplore.</p>
<p>That&rsquo;s a workaround at least. I know this example with the Idle process is not really close to real life, but the concept is true for a lot of objects. Using Idle was just to prove the point. You can try these commands on your own machine. They should work on any machine, as long as Internet Explorer is running.
For some reason the custom objects that I have tried this on doesn&rsquo;t work with this workaround. For me it has worked with the objects returned from several built-in cmdlets, so give it a try. It might just work.</p>

        </div>

        
        <div class="main-content-preview">
            <h1>Get-Type alternative for $null values</h1>
            
            <p>Sometimes its useful to get information about object properties in PowerShell. You might be writing a script where you want to extract information from a series of objects and you need to know what data type a property contains. Often this is not a big problem since you can use the GetType function that most objects have.</p>
<p>Then you run in to the problem that I had recently: You expect a series of objects and you check the types on the properties and suddenly a few of them doesn&rsquo;t have the function GetType for some reason. What I realized was that if a property is Null then a lot of features for that property doesn&rsquo;t work anymore. I did figure out a workaround for this, even if its not very pretty. I thought I share this in case more people stumble on the same issue.</p>
<p>So what is the problem? Well, it seems like PowerShell considers a property with a null value to not exist, kind of. Let me do an example with Get-Process.</p>
<p>Lets start with how it usually works, when there is no problem: Get-Process for Internet Explorer. Get-Process returns one object per process as usual. Lets pick a property that we want to examine. I pick StartTime which I expect is when the process started, but I haven&rsquo;t checked. It doesn&rsquo;t matter what it means for this example.
Then we check the data type for that property. Something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Sample any object property. </span>
</span></span><span class="line"><span class="cl"><span class="c"># In this case StartTime from IE coming from from Get-Process.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">iexplore</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span></code></pre></div><p>This will return &ldquo;DateTime&rdquo;. So far so good. What if we look for a process that doesn&rsquo;t have a value for StartTime? How about the mysterious Idle process?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Doesnt work if the property is empty</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">Idle</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span></code></pre></div><p>This returns an error: &ldquo;You cannot call a method on a null-valued expression.&rdquo;
That&rsquo;s a bit weird since its the same kind of object. They are both of the type System.Diagnostics.Process, but they seem to be different. Well, they are the same type, but PowerShell behaves this way when the value is null. You can get the feeling that it doesn&rsquo;t exist, and cannot have any functions.</p>
<p>There is other ways to get this information. One way is to use the output from Get-Member in a not-so-standard way. Parsing through the result to get what you need. This is a last resort, but works in most cases.</p>
<p>This is what you get if you pipe the object to Get-Member:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">PS C:\&gt;$sampleObject | Get-Member -MemberType Properties | Where-Object {$_.Name -eq &#34;StartTime&#34;}
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">   TypeName: System.Diagnostics.Process
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">Name      MemberType Definition
</span></span><span class="line"><span class="cl">----      ---------- ----------
</span></span><span class="line"><span class="cl">StartTime Property   datetime StartTime {get;}
</span></span></code></pre></div><p>Under Definition you can see &ldquo;datetime&rdquo;. That&rsquo;s what we need. So lets parse through Definition and remove everything after the first space.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># This time we are using the output from Get-Member, selecting StartTime </span>
</span></span><span class="line"><span class="cl"><span class="c"># and removing anything after the space (&#39; &#39;).</span>
</span></span><span class="line"><span class="cl"><span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="n">Idle</span>
</span></span><span class="line"><span class="cl"><span class="nv">$propertyName</span> <span class="p">=</span> <span class="nv">$sampleObject</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="n">-MemberType</span> <span class="n">Properties</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                              <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="s1">&#39;StartTime&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">Remove</span><span class="p">(</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">IndexOf</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">)</span>
</span></span></code></pre></div><p>This will output &ldquo;datetime&rdquo;. As long as you are not case sensitive, this could work as a workaround.
I would prefer the first option to use the GetType so why not use that one first and then fall back on the second option if it doesn&rsquo;t work. Lets try both iexplore and Idle while we&rsquo;re at it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$processes</span> <span class="p">=</span> <span class="s1">&#39;Idle&#39;</span><span class="p">,</span><span class="s1">&#39;iexplore&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$process</span> <span class="k">in</span> <span class="nv">$processes</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sampleObject</span> <span class="p">=</span> <span class="nb">Get-Process</span> <span class="n">-Name</span> <span class="nv">$process</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$typeName</span> <span class="p">=</span> <span class="nv">$sampleObject</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">StartTime</span><span class="p">.</span><span class="py">GetType</span><span class="p">().</span><span class="py">Name</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$propertyName</span> <span class="p">=</span> <span class="nv">$sampleObject</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="n">-MemberType</span> <span class="n">Properties</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                                          <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="s1">&#39;StartTime&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$typeName</span> <span class="p">=</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">Remove</span><span class="p">(</span> <span class="nv">$propertyName</span><span class="p">.</span><span class="py">Definition</span><span class="p">.</span><span class="py">IndexOf</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">catch</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$typeName</span> <span class="p">=</span> <span class="s1">&#39;Doh!&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;</span><span class="nv">$process</span><span class="s2"> = </span><span class="nv">$typeName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This should now output &ldquo;datetime&rdquo; for Idle and &ldquo;DateTime&rdquo; for iexplore.</p>
<p>That&rsquo;s a workaround at least. I know this example with the Idle process is not really close to real life, but the concept is true for a lot of objects. Using Idle was just to prove the point. You can try these commands on your own machine. They should work on any machine, as long as Internet Explorer is running.
For some reason the custom objects that I have tried this on doesn&rsquo;t work with this workaround. For me it has worked with the objects returned from several built-in cmdlets, so give it a try. It might just work.</p>


            <p>- Written by John Roos  
            
                
                
                on December 20, 2014</p>

            
                <div class="disqus-section">
                    
                </div>
            
        </div>

    </div>
    


            </div>
        </div>
    </body>
</html>
