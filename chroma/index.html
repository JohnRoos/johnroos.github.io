 
 

 

 

 

 

 


<!DOCTYPE html>
<html lang="en">




    



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=5.0, minimum-scale=0.86">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">

    <meta name='twitter:card'        content='summary' />
    <meta name='twitter:site'        content='@johnmroos'/>
    <meta name='twitter:creator'     content='@johnmroos'/>
    <meta name='twitter:title'       content='Chroma' />
    <meta name='twitter:description' content='Code highlight demo using Chroma.
#REQUIRES -Version 4.0 &lt;# .Synopsis Reads an ini file and creates an object based on the content of the file .DESCRIPTION Reads an ini file and creates an object based on the content of the file. One property per key/value. Sections will be named with surrounding brackets and will contain a list of objects based on the keys within that section. Comments will be ignored. Created by John Roos Web: http://blog.' />
    
    <meta name='twitter:domain'      content='https://blog.roostech.se/'/>
    

    <title>Chroma</title>
    <meta name="description" content="Code highlight demo using Chroma.
#REQUIRES -Version 4.0 &lt;# .Synopsis Reads an ini file and creates an object based on the content of the file .DESCRIPTION Reads an ini file and creates an object based on the content of the file. One property per key/value. Sections will be named with surrounding brackets and will contain a list of objects based on the keys within that section. Comments will be ignored. Created by John Roos Web: http://blog."/>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9F2VG64X4H"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9F2VG64X4H', { 'anonymize_ip': false });
}
</script>

</head><body>
        <div class="container">
<input class="explorer-toggle" type="checkbox" id="explorer-toggle">
<label class="explorer-toggle-label" for="explorer-toggle"><div class="explorer-toggle-label-clickablearea"></div></label>

<div class="explorer-toggle-label-selection"></div>

<div class="left-menu-button-bar"></div>

<diV class='left-menu'>
    
    <ul class="root">
        <li class="root"><div class="menu-item folder open"><a class="menu-item-site" href="https://blog.roostech.se/">blog.roostech.se (HUGOVSCODE)</a></div>
            <ul>  
                <li><span class="menu-item folder open">content</span>
                    <ul>
                        <li><span class="menu-item folder open">posts</span>
                            <ul>
                                
                                <li ><a href="/posts/set-up-built-in-authentication-for-azure-static-web-app/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Set up built-in authentication for Azure Static Web App.md</span></a></li>
                                
                                <li ><a href="/posts/deploy-azure-static-web-app-using-bicep-and-yaml-pipeline/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Static Web App using Bicep and YAML pipeline.md</span></a></li>
                                
                                <li ><a href="/posts/get-function-configuration-from-deployed-function-app/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get function configuration from deployed Function App.md</span></a></li>
                                
                                <li ><a href="/posts/deploy-azure-function-app-without-downtime/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Deploy Azure Function App without downtime.md</span></a></li>
                                
                                <li ><a href="/posts/moving-from-blogger-to-github-pages-with-hugo/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Moving from Blogger to GitHub Pages using Hugo.md</span></a></li>
                                
                                <li ><a href="/posts/pester-5-discovery-and-testcases/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Pester 5: Discovery and TestCases.md</span></a></li>
                                
                                <li ><a href="/posts/create-and-use-azure-table-storage-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Create and use Azure Table storage with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/use-edit-command-to-discover-the-code-behind-built-in-cmdlets/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use Edit-Command to discover the code behind built-in cmdlets.md</span></a></li>
                                
                                <li ><a href="/posts/invoke-restmethod-with-anti-forgery-tokens-in-header-and-cookie/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Invoke-RestMethod with anti-forgery tokens in header and cookie.md</span></a></li>
                                
                                <li ><a href="/posts/introducing-the-inimanager-module/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Introducing the IniManager module.md</span></a></li>
                                
                                <li ><a href="/posts/use-powershell-jobs-to-ping-many-from-many-with-log/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Use PowerShell jobs to ping many from many with log.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-logo-made-with-css3/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">PowerShell logo made with CSS3.md</span></a></li>
                                
                                <li ><a href="/posts/what-is-this-here-string-people-are-talking-about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">What is this here-string people are talking about?.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-parameters-in-powershell-executes-before-you-know-it/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic parameters in PowerShell executes before you know it.md</span></a></li>
                                
                                <li ><a href="/posts/making-powershell-expressions-easier/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Making PowerShell expressions easier.md</span></a></li>
                                
                                <li ><a href="/posts/simple-select-from-database-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Simple select from database with PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-use-splatting-in-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to use splatting in PowerShell.md</span></a></li>
                                
                                <li ><a href="/posts/get-imdbmovie-using-invoke-webrequest/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-IMDBmovie using Invoke-WebRequest.md</span></a></li>
                                
                                <li ><a href="/posts/classes-in-powershell-5.0/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Classes in Powershell 5.0.md</span></a></li>
                                
                                <li ><a href="/posts/how-to-get-started-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">How to get started with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-find-hotfix-status/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Find hotfix status.md</span></a></li>
                                
                                <li ><a href="/posts/powershell-script-write-object-to-sql/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Powershell script: Write object to SQL.md</span></a></li>
                                
                                <li ><a href="/posts/get-type-alternative-for-null-values/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Get-Type alternative for $null values.md</span></a></li>
                                
                                <li ><a href="/posts/compress-files-to-zip-with-powershell/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Compress files to Zip with Powershell.md</span></a></li>
                                
                                <li ><a href="/posts/enable-real-time-jmx-monitoring-in-cognos/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Enable real time JMX monitoring in Cognos.md</span></a></li>
                                
                                <li ><a href="/posts/move-data-or-log-files-for-tempdb-in-sql-server/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Move data or log files for TempDB in SQL Server.md</span></a></li>
                                
                                <li ><a href="/posts/resources-for-remotefx-in-windows-server-2012/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Resources for RemoteFX in Windows Server 2012.md</span></a></li>
                                
                                <li ><a href="/posts/rdp-8.0-for-windows-7-sp1/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">RDP 8.0 for Windows 7 SP1.md</span></a></li>
                                
                                <li ><a href="/posts/improving-remotefx-performance-in-hyper-v/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Improving RemoteFX performance in Hyper-V.md</span></a></li>
                                
                                <li ><a href="/posts/configure-remotefx-in-hyper-v-running-windows-server-2012-with-low-end-gpu/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Configure RemoteFX in Hyper-V running Windows Server 2012 with low end GPU.md</span></a></li>
                                
                                <li ><a href="/posts/sqlps-and-its-limitations/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">SQLPS and its limitations.md</span></a></li>
                                
                                <li ><a href="/posts/script-deployment-of-ssis-packages-from-folder/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Script deployment of SSIS packages from folder.md</span></a></li>
                                
                                <li ><a href="/posts/dynamic-deploy-of-ssrs-reports-using-rs.exe/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Dynamic deploy of SSRS reports using rs.exe.md</span></a></li>
                                
                                <li ><a href="/posts/remove-headers-in-excel-exports-to-fix-column-alignment/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Remove headers in Excel exports to fix column alignment.md</span></a></li>
                                
                                <li ><a href="/posts/using-executionlog2-for-statistics-and-monitoring/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Using ExecutionLog2 for statistics and monitoring.md</span></a></li>
                                
                            </ul>
                        </li>
                        <li><span class="menu-item folder open">pages</span>
                            <ul>
                                
                                <li ><a href="/about/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">About me.md</span></a></li>
                                
                                <li class="current"><a href="/chroma/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">Chroma.md</span></a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><span class="menu-item folder">data</span></li>
                <li><span class="menu-item folder">layouts</span></li>
                <li><span class="menu-item folder">resources</span></li>
                <li><span class="menu-item folder">static</span></li>
                <li><span class="menu-item folder open">themes</span>
                    <ul>
                        <li><span class="menu-item folder open">hugovscode</span>
                            <ul>
                                <li><a href="https://github.com/JohnRoos/HugoVSCode/"><span class="rotate-letter md-icon">&#10144;</span><span class="menu-item">.git</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>config.toml</li>
            </ul>
        </li>
    </ul>
  

    
</diV>
                <div class ="main-tabs">
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/">Home.md</a> 
                    </div>
                
                    <div class="main-tab current">
                        <span class="rotate-letter md-icon">&#10144;</span> <i>chroma.md</i> 
                    </div>
                
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/set-up-built-in-authentication-for-azure-static-web-app/">Set up built-in authentication for Azure Static Web App.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-static-web-app-using-bicep-and-yaml-pipeline/">Deploy Azure Static Web App using Bicep and YAML pipeline.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/get-function-configuration-from-deployed-function-app/">Get function configuration from deployed Function App.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/deploy-azure-function-app-without-downtime/">Deploy Azure Function App without downtime.md</a>
                    </div>
                
                    <div class="main-tab">
                        <span class="rotate-letter md-icon">&#10144;</span> <a href="/posts/moving-from-blogger-to-github-pages-with-hugo/">Moving from Blogger to GitHub Pages using Hugo.md</a>
                    </div>
                
                </div>
            
            
            <div class='main'>
    <div class="main-path">
        <span><a class="path-link" href="https://blog.roostech.se/">blog.roostech.se</a></span><span class="folder">content</span><span class="folder">pages</span><span class="folder">Chroma.md</span>
        
    </div>
    
    <div class="main-content-toggle">

        
        <input class="source-preview-split" type="checkbox" id="source-preview-split-toggle">
        <label class="source-preview-split-label" for="source-preview-split-toggle"></label>

        <input class="source-toggle" type="checkbox" id="source-toggle">
        <label class="source-toggle-label" for="source-toggle"></label>

        <div class="main-content">
            ---<br />
            <span class="md-frontmatter">title</span>: <span class="md-frontmatter-string">Chroma</span><br />
            <span class="md-frontmatter">date</span>: 0001-01-01 00:00:00 &#43;0000 UTC<br />
            <span class="md-frontmatter">draft</span>: <span class="md-frontmatter">false</span><br />
            <span class="md-frontmatter">author</span>: <span class="md-frontmatter-string">John Roos</span><br />
            ----
            <p>Code highlight demo using <a href="https://github.com/alecthomas/chroma">Chroma</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#</span><span class="k">REQUIRES</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 4.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">Synopsis</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Reads an ini file and creates an object based on the content of the file
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Reads an ini file and creates an object based on the content of the file. One property per key/value. Sections will be named with surrounding brackets and will contain a list of objects based on the keys within that section.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Comments will be ignored.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Created by John Roos 
</span></span></span><span class="line"><span class="cl"><span class="cm">    Web: http://blog.roostech.se
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Get-Ini -Path &#34;C:\config.ini&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Opens the file config.ini and creates an object based on that file.
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">OUTPUTS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Outputs an custom object of the type File.Ini
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Ini</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">CmdletBinding</span><span class="p">(</span><span class="na">DefaultParameterSetName</span><span class="p">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Enter the path for the ini file</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">ValueFromPipelineByPropertyName</span><span class="p">=</span><span class="vm">$true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">Position</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">ParameterSetName</span><span class="p">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Enter the path for the ini file&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nb">ValidateScript</span><span class="p">({</span><span class="nb">Test-Path</span> <span class="nv">$_</span><span class="p">})]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">Process</span> 
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$iniFile</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="nv">$Path</span> <span class="n">-Verbose:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentSection</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentKey</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentValue</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniSectionHash</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$line</span> <span class="k">in</span> <span class="nv">$iniFile</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Trim</span><span class="p">().</span><span class="py">StartsWith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span> <span class="o">-and</span> <span class="nv">$line</span><span class="p">.</span><span class="py">EndsWith</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Found new section.&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nv">$currentSection</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">Write-Verbose</span> <span class="s2">&#34;Creating section property based on array:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$keyobj</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$keyobj</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.Ini.Config&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$iniSectionHash</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentSection</span><span class="p">,</span><span class="nv">$keyobj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">Write-Verbose</span> <span class="s2">&#34;Created section property: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nv">$iniConfigArray</span><span class="p">.</span><span class="py">count</span> <span class="o">-gt</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$rootSection</span> <span class="p">=</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$currentSection</span> <span class="p">=</span> <span class="nv">$line</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Current section: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Verbose</span> <span class="s2">&#34;Parsing line: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Contains</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$keyvalue</span> <span class="p">=</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$currentKey</span>   <span class="p">=</span> <span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$currentValue</span> <span class="p">=</span> <span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$valuehash</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$currentKey</span> <span class="p">=</span> <span class="nv">$currentValue</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$iniConfigArray</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentKey</span><span class="p">,</span> <span class="nv">$currentValue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Added keyvalue: </span><span class="p">$(</span><span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="s2"> = </span><span class="p">$(</span><span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> 
</span></span><span class="line"><span class="cl">            <span class="cm">&lt;# below was for handling comments, but I wont do it...
</span></span></span><span class="line"><span class="cl"><span class="cm">              elseif ($line.Contains(&#39;#&#39;) -or $line.Contains(&#39;;&#39;)) {
</span></span></span><span class="line"><span class="cl"><span class="cm">                [string]$currentKey   = $line
</span></span></span><span class="line"><span class="cl"><span class="cm">                [string]$currentValue = &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">                $valuehash = @{
</span></span></span><span class="line"><span class="cl"><span class="cm">                    $currentKey = $currentValue
</span></span></span><span class="line"><span class="cl"><span class="cm">                }
</span></span></span><span class="line"><span class="cl"><span class="cm">                $iniConfigArray.Add($currentKey, $currentValue)
</span></span></span><span class="line"><span class="cl"><span class="cm">                Write-Verbose &#34;Added comment: $currentKey&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">            }#&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$keyobj</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$keyobj</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.ini.Section&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$iniSectionHash</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentSection</span><span class="p">,</span><span class="nv">$keyobj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Write-Verbose</span> <span class="s2">&#34;Created last section property: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniSectionHash</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$rootSection</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$key</span> <span class="k">in</span> <span class="nv">$rootSection</span><span class="p">.</span><span class="n">keys</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Add-Member</span> <span class="n">-InputObject</span> <span class="nv">$result</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="nv">$key</span> <span class="n">-Value</span> <span class="nv">$rootSection</span><span class="p">.</span><span class="nv">$key</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.ini&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">Return</span> <span class="nv">$result</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Classes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">class</span><span class="w"> </span><span class="nb">ComputerPSOverload1
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="nv">$Domain</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="py">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="py">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="nv">$ComputerName</span><span class="s2">.</span><span class="nv">$Domain</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">class</span><span class="w"> </span><span class="nb">ComputerPSOverload2 :</span> <span class="n">ComputerPSOverload1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="py">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="py">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="nv">$prefix</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Pester</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Describe</span> <span class="s1">&#39;Pester 5 Example&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$number</span> <span class="k">in</span> <span class="mf">1</span><span class="p">.</span><span class="mf">.10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">It</span> <span class="s2">&#34;</span><span class="nv">$number</span><span class="s2"> is a number&#34;</span> <span class="n">-TestCases</span> <span class="vm">@</span><span class="p">{</span><span class="s1">&#39;digit&#39;</span> <span class="p">=</span> <span class="nv">$number</span><span class="p">}</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$digit</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-BeOfType</span> <span class="p">[</span><span class="no">int</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl"><span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Run</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">Describe</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">    <span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">BeforeEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Context</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">BeforeEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">        <span class="n">It</span> <span class="s2">&#34;Discovery&#34;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-TestCases</span> <span class="vm">@</span><span class="p">{</span><span class="s1">&#39;Discovery&#39;</span> <span class="p">=</span> <span class="s1">&#39;Discovery&#39;</span><span class="p">}</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">AfterEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">AfterEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Run</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Strings</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">This is my </span><span class="nv">$string</span><span class="sh">. There are </span><span class="nv">${many}</span><span class="sh"> like it, but this one is mine.
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="sh">@&#39;
</span></span></span><span class="line"><span class="cl"><span class="sh">This is my $string. There are ${many} like it, but this one is mine.
</span></span></span><span class="line"><span class="cl"><span class="sh">&#39;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="s2">&#34;This is my </span><span class="nv">$string</span><span class="s2">. There are </span><span class="nv">${many}</span><span class="s2"> like it, but this one is mine.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="s1">&#39;This is my $string. There are ${many} like it, but this one is mine.&#39;</span>
</span></span></code></pre></div>
        </div>

        
        <div class="main-content-preview">
            <h1>Chroma</h1>
            
            <p>Code highlight demo using <a href="https://github.com/alecthomas/chroma">Chroma</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#</span><span class="k">REQUIRES</span><span class="w"> </span><span class="kd">-Version</span><span class="na"> 4.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">&lt;#
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">Synopsis</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Reads an ini file and creates an object based on the content of the file
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">DESCRIPTION</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Reads an ini file and creates an object based on the content of the file. One property per key/value. Sections will be named with surrounding brackets and will contain a list of objects based on the keys within that section.
</span></span></span><span class="line"><span class="cl"><span class="cm">    Comments will be ignored.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Created by John Roos 
</span></span></span><span class="line"><span class="cl"><span class="cm">    Web: http://blog.roostech.se
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">EXAMPLE</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Get-Ini -Path &#34;C:\config.ini&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Opens the file config.ini and creates an object based on that file.
</span></span></span><span class="line"><span class="cl"><span class="cm">.</span><span class="sd">OUTPUTS</span><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">    Outputs an custom object of the type File.Ini
</span></span></span><span class="line"><span class="cl"><span class="cm">#&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Ini</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">CmdletBinding</span><span class="p">(</span><span class="na">DefaultParameterSetName</span><span class="p">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">param</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Enter the path for the ini file</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">ValueFromPipelineByPropertyName</span><span class="p">=</span><span class="vm">$true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">Position</span><span class="p">=</span><span class="mf">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">ParameterSetName</span><span class="p">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="na">HelpMessage</span><span class="p">=</span><span class="s1">&#39;Enter the path for the ini file&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nb">ValidateScript</span><span class="p">({</span><span class="nb">Test-Path</span> <span class="nv">$_</span><span class="p">})]</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Path</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">Process</span> 
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$iniFile</span> <span class="p">=</span> <span class="nb">Get-Content</span> <span class="nv">$Path</span> <span class="n">-Verbose:</span><span class="vm">$false</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentSection</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentKey</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currentValue</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniSectionHash</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$line</span> <span class="k">in</span> <span class="nv">$iniFile</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Trim</span><span class="p">().</span><span class="py">StartsWith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span> <span class="o">-and</span> <span class="nv">$line</span><span class="p">.</span><span class="py">EndsWith</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Found new section.&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nv">$currentSection</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">Write-Verbose</span> <span class="s2">&#34;Creating section property based on array:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$keyobj</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$keyobj</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.Ini.Config&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$iniSectionHash</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentSection</span><span class="p">,</span><span class="nv">$keyobj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">Write-Verbose</span> <span class="s2">&#34;Created section property: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nv">$iniConfigArray</span><span class="p">.</span><span class="py">count</span> <span class="o">-gt</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$rootSection</span> <span class="p">=</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">                    <span class="p">[</span><span class="no">hashtable</span><span class="p">]</span><span class="nv">$iniConfigArray</span> <span class="p">=</span> <span class="p">[</span><span class="no">ordered</span><span class="p">]</span><span class="vm">@</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$currentSection</span> <span class="p">=</span> <span class="nv">$line</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Current section: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Verbose</span> <span class="s2">&#34;Parsing line: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Contains</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$keyvalue</span> <span class="p">=</span> <span class="nv">$line</span><span class="p">.</span><span class="py">Split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$currentKey</span>   <span class="p">=</span> <span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$currentValue</span> <span class="p">=</span> <span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$valuehash</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$currentKey</span> <span class="p">=</span> <span class="nv">$currentValue</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$iniConfigArray</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentKey</span><span class="p">,</span> <span class="nv">$currentValue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Write-Verbose</span> <span class="s2">&#34;Added keyvalue: </span><span class="p">$(</span><span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="s2"> = </span><span class="p">$(</span><span class="nv">$keyvalue</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> 
</span></span><span class="line"><span class="cl">            <span class="cm">&lt;# below was for handling comments, but I wont do it...
</span></span></span><span class="line"><span class="cl"><span class="cm">              elseif ($line.Contains(&#39;#&#39;) -or $line.Contains(&#39;;&#39;)) {
</span></span></span><span class="line"><span class="cl"><span class="cm">                [string]$currentKey   = $line
</span></span></span><span class="line"><span class="cl"><span class="cm">                [string]$currentValue = &#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">                $valuehash = @{
</span></span></span><span class="line"><span class="cl"><span class="cm">                    $currentKey = $currentValue
</span></span></span><span class="line"><span class="cl"><span class="cm">                }
</span></span></span><span class="line"><span class="cl"><span class="cm">                $iniConfigArray.Add($currentKey, $currentValue)
</span></span></span><span class="line"><span class="cl"><span class="cm">                Write-Verbose &#34;Added comment: $currentKey&#34;
</span></span></span><span class="line"><span class="cl"><span class="cm">            }#&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$keyobj</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniConfigArray</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$keyobj</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.ini.Section&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$iniSectionHash</span><span class="p">.</span><span class="py">Add</span><span class="p">(</span><span class="nv">$currentSection</span><span class="p">,</span><span class="nv">$keyobj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Write-Verbose</span> <span class="s2">&#34;Created last section property: </span><span class="nv">$currentSection</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">PSObject</span> <span class="n">-Property</span> <span class="nv">$iniSectionHash</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$rootSection</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$key</span> <span class="k">in</span> <span class="nv">$rootSection</span><span class="p">.</span><span class="n">keys</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Add-Member</span> <span class="n">-InputObject</span> <span class="nv">$result</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="nv">$key</span> <span class="n">-Value</span> <span class="nv">$rootSection</span><span class="p">.</span><span class="nv">$key</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span><span class="p">.</span><span class="py">PSObject</span><span class="p">.</span><span class="py">TypeNames</span><span class="p">.</span><span class="py">Insert</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="s1">&#39;File.ini&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">Return</span> <span class="nv">$result</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Classes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">class</span><span class="w"> </span><span class="nb">ComputerPSOverload1
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="nv">$ComputerName</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="nv">$Domain</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="py">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="py">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="nv">$ComputerName</span><span class="p">,</span> <span class="p">[</span><span class="no">string</span><span class="p">]</span><span class="nv">$Domain</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="nv">$ComputerName</span><span class="s2">.</span><span class="nv">$Domain</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">class</span><span class="w"> </span><span class="nb">ComputerPSOverload2 :</span> <span class="n">ComputerPSOverload1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">string</span><span class="p">]</span> <span class="n">GetFQDN</span><span class="p">([</span><span class="no">string</span><span class="p">]</span><span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="p">.</span><span class="py">ComputerName</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span> <span class="o">-and</span> <span class="nv">$this</span><span class="p">.</span><span class="py">Domain</span> <span class="o">-ne</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="nv">$prefix</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">ComputerName</span><span class="p">)</span><span class="s2">.</span><span class="p">$(</span><span class="nv">$this</span><span class="p">.</span><span class="n">Domain</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Pester</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Describe</span> <span class="s1">&#39;Pester 5 Example&#39;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$number</span> <span class="k">in</span> <span class="mf">1</span><span class="p">.</span><span class="mf">.10</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">It</span> <span class="s2">&#34;</span><span class="nv">$number</span><span class="s2"> is a number&#34;</span> <span class="n">-TestCases</span> <span class="vm">@</span><span class="p">{</span><span class="s1">&#39;digit&#39;</span> <span class="p">=</span> <span class="nv">$number</span><span class="p">}</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$digit</span> <span class="p">|</span> <span class="n">Should</span> <span class="n">-BeOfType</span> <span class="p">[</span><span class="no">int</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl"><span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Run</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">Describe</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">    <span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">BeforeEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Context</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BeforeAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">BeforeEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">        <span class="n">It</span> <span class="s2">&#34;Discovery&#34;</span> <span class="n">-Tag</span> <span class="s1">&#39;Discovery&#39;</span> <span class="n">-TestCases</span> <span class="vm">@</span><span class="p">{</span><span class="s1">&#39;Discovery&#39;</span> <span class="p">=</span> <span class="s1">&#39;Discovery&#39;</span><span class="p">}</span> <span class="n">-Skip:</span><span class="nv">$Discovery</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">AfterEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">AfterEach</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Run</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">AfterAll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Run</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c"># Discovery</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Strings</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="sh">@&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">This is my </span><span class="nv">$string</span><span class="sh">. There are </span><span class="nv">${many}</span><span class="sh"> like it, but this one is mine.
</span></span></span><span class="line"><span class="cl"><span class="sh">&#34;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="sh">@&#39;
</span></span></span><span class="line"><span class="cl"><span class="sh">This is my $string. There are ${many} like it, but this one is mine.
</span></span></span><span class="line"><span class="cl"><span class="sh">&#39;@</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="s2">&#34;This is my </span><span class="nv">$string</span><span class="s2">. There are </span><span class="nv">${many}</span><span class="s2"> like it, but this one is mine.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$str</span> <span class="p">=</span> <span class="s1">&#39;This is my $string. There are ${many} like it, but this one is mine.&#39;</span>
</span></span></code></pre></div>

            <p>- Written by John Roos  
            </p>

            
        </div>

    </div>
    


            </div>
        </div>
    </body>
</html>
